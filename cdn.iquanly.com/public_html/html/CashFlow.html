<style>
.k-block, .k-button, .k-textbox, .k-drag-clue, .k-touch-scrollbar, .k-window, .k-window-titleless .k-window-content, .k-window-action, .k-inline-block, .k-grid .k-filter-options, .k-grouping-header .k-group-indicator, .k-autocomplete, .k-multiselect, .k-combobox, .k-dropdown, .k-dropdown-wrap, .k-datepicker, .k-timepicker, .k-colorpicker, .k-datetimepicker, .k-numerictextbox, .k-picker-wrap, .k-numeric-wrap, .k-colorpicker, .k-list-container, .k-calendar-container, .k-calendar td, .k-calendar .k-link, .k-treeview .k-in, .k-editor-inline, .k-tooltip, .k-tile, .k-slider-track, .k-slider-selection, .k-upload {
    -moz-border-radius: 3px!important;
    -webkit-border-radius: 3px!important;
    -khtml-border-radius: 3px!important;
    border-radius: 3px!important;
}
.k-autocomplete, .k-button, .k-draghandle, .k-dropdown-wrap, .k-grid-header, .k-grouping-header, .k-header, .k-numeric-wrap, .k-pager-wrap, .k-panelbar .k-tabstrip-items .k-item, .k-picker-wrap, .k-progressbar, .k-state-highlight, .k-tabstrip-items .k-item, .k-textbox, .k-toolbar, .km-pane-wrapper>.km-pane>.km-view>.km-content {
    background-image: url(textures/highlight.png);
    background-image: none,-webkit-gradient(linear,left top,left bottom,from(rgba(255,255,255,.6)),to(rgba(255,255,255,0)));
    background-image: none,-webkit-linear-gradient(top,rgba(255,255,255,.6) 0,rgba(255,255,255,0) 100%);
    background-image: none,linear-gradient(to bottom,rgba(255,255,255,.6) 0,rgba(255,255,255,0) 100%);
    background-position: 50% 50%;
    background-color: #eae8e8;
}
input[type="text"]:disabled, input[type="password"]:disabled, input[type="email"]:disabled, input[type="number"]:disabled, select:disabled, textarea:disabled, button:disabled, a:disabled
 input[disabled], textarea[disabled], select[disabled='disabled'] {
    background: #ececec!important;
    color: #7d7d7d!important;
    -webkit-text-fill-color: #7d7d7d!important;
    opacity: 1!important;
    -webkit-opacity: 1;
    cursor: not-allowed!important;
    box-shadow: none!important;
}
 
.k-dropdown-wrap .k-input, .k-picker-wrap .k-input:not(.k-textbox), .k-numeric-wrap .k-input .tblBox .k-picker-wrap .k-input {
    padding: 5px 8px;
    background: none;
    min-height: 18px;
    height: 18px;
    box-sizing: content-box;
    text-indent: 0;
}
.k-gantt-toolbar .k-state-default, .k-grid .k-grouping-header, .k-grid-header, .k-grid-header-wrap, .k-grouping-header .k-group-indicator, .k-header, .k-pager-wrap, .k-pager-wrap .k-link, .k-pager-wrap .k-textbox {
    border-color: #c5c5c5;
}
.form-group .form-label {
    width: 120px;
    float: left;
    font-weight: bold;
}
.form-group .control-label {
    padding: 8px 5px 0;
    line-height: 17px;
    color: #111;
    margin: 0;
}
.sortView .boxLeftC aside .k-header {    
    margin-top: 0px;
}
.form-wrapper.form-labels-90 .form-wrap, .form-wrapper .form-labels-90 .form-wrap {
    margin-left: 90px;
}
 
.form-group .form-wrap.form-control-static {
    padding: 9px 0 5px;
    min-height: 32px;
}
.form-wrapper *:not(th):not(td):not(.paging-box):not([class*="k-"]) {
    box-sizing: border-box;
}
.form-wrapper.form-labels-90 .form-label, .form-wrapper .form-labels-90 .form-label {
    width: 90px;
}
.content-list div[class*="col-md-"] .form-group .form-label {
    font-weight: normal;
}
.content-list .k-widget {
    max-width: 100%;
}
.k-datetimepicker {
     
    background: #ececec!important;
 
}
input[data-role="datetimepicker"]{
    font-size: 13px!important;
    padding-top: 8px!important;
}
textarea.tblBox_Des2 {
    height: 80px;
    pointer-events: all!important;
    cursor: default!important;
}
 
textarea.tblBox_Des {
    font-style: italic;
    border: none;
    border-left: 1px solid #eee;
    padding: 0 0 0 15px;
    height: 67px;
    overflow-y: auto;
    color: #999;
    line-height: 18px;
    width: 100%;
}
.kv-window-footer, .kv-group-btn {
    padding: 0;
    text-align: right;
    clear: both;
}
.content-list div[class*="col-md-"] .form-group {
    border-top: 1px solid #eee;
    margin: 0;
}
.content-list div[class*="col-md-"].description-detail .form-group, .content-list div[class*="col-md-"]:not(.description-detail):not(.col-md-12) .form-group:first-child {
    border-top: none;
}
.form-wrapper .form-group {
    min-height: 24px;
    clear: both;
}

@media (min-width: 992px){
 
    .content-list div[class*="col-md-"] .form-group {
        padding: 3px 0;
    }
}

.kvTabs > ul li a.active{
    background-color: transparent!important;
}
.iptBtn {
    background: #ebebeb;
    border: none;
    border-left: 1px solid #ccc;
    width: 32px;
    text-align: center;
    color: #989898;
    line-height: 28px;
    vertical-align: middle;
    position: relative;
    border-radius: 0 3px 3px 0;
    height: 30px;
}
a.iptBtn {
    display: inline-block;
}

.form-wrap.wrap-inside-btn .iptBtn {
    position: absolute;
     
}
#partnerSearchInput {
    height: 30px;
    width: 100%!important;
}
.cash-autocomplete1{
    float: left;
    width: calc(100% - 32px)!important;
}

.k-window-cashflow span.mainSelect {
    width: calc(100% - 32px);
}

.k-window-poup .k-window-titlebar {
    background-color: #29a1cd;
}


.sortDateTimeOtherBox [kendo-calendar]{
    width: 19.2721348em;
}

.sortDateTimeOtherBox{
    width: 515px;
}



.kv-window .row, .kv-window .row [class^=col-md], .kv-window [class^=form-] {
    box-sizing: border-box;
}
.form-control-kv:not(.k-input) {
    display: block;
    width: 100%;
    font-size: 13px;
    line-height: 18px;
    color: #121212;
    background-color: #fff;
    background-image: none;
    box-sizing: border-box;
    -webkit-border-radius: 0;
    -moz-border-radius: 0;
    border-radius: 0;
}
.form-control-kv:not(.k-input):not(.k-widget) {
    height: 32px;
    padding: 7px;
    border: solid #ccc;
    border-width: 0 0 1px;
    font-size: inherit;
    -webkit-box-shadow: inset 0 0 1px rgba(0,0,0,.075);
    -moz-box-shadow: inset 0 0 1px rgba(0,0,0,.075);
    box-shadow: inset 0 0 1px rgba(0,0,0,.075);
    -webkit-transition: border-color ease-in-out .15s,box-shadow ease-in-out .15s .2s linear;
    -moz-transition: border-color ease-in-out .15s,box-shadow ease-in-out .15s .2s linear;
    -o-transition: border-color ease-in-out .15s,box-shadow ease-in-out .15s .2s linear;
    -ms-transition: border-color ease-in-out .15s,box-shadow ease-in-out .15s .2s linear;
    transition: border-color ease-in-out .15s,box-shadow ease-in-out .15s .2s linear;
}
.form-wrapper :not(th):not(td):not(.paging-box):not([class*=k-]) {
    -webkit-box-sizing: border-box;
    -moz-box-sizing: border-box;
    box-sizing: border-box;
}
.form-control-kv:not(.k-input):not(.k-widget):focus {
    border-color: #4bac4d;
    border-bottom-width: 2px;
    outline: 0;
    -webkit-transition: all .2s ease-out;
    -moz-transition: all .2s ease-out;
    -o-transition: all .2s ease-out;
    -ms-transition: all .2s ease-out;
    transition: all .2s ease-out;
    -webkit-box-shadow: none;
    -moz-box-shadow: none;
    box-shadow: none;
}
.k-window-cashflowbank .textarea-autoHeight {
    overflow-y: scroll;
    max-height: 95px;
    min-height: 34px;
}
</style>
<section class="mainLeft fll fr ng-scope">
  <div class="filter-report">
    <article class="boxLeft kvTabsLeft uln">
      <article class="txtT">
        <kv-tabs on-change="tabTypeChanged" ng-model="CashFlowType" class="ng-untouched ng-valid ng-isolate-scope ng-not-empty ng-dirty ng-valid-parse">
          <div class="kvTabs clearfix ulN">
            <ul class="mr-bg">
              <!-- ngRepeat: pane in panes -->
              <li ng-repeat="pane in panes" class="ng-scope"><a skip-disable="" tabindex="-1" kv-focus-item="tabBut_0" ng-click="select(pane, false, $index)" class="tabBut_0  tabbut_new active" ng-class="{'active':pane.selected}">Tiền mặt</a></li>
              <!-- end ngRepeat: pane in panes -->
              <li ng-repeat="pane in panes" class="ng-scope"><a skip-disable="" tabindex="-1" kv-focus-item="tabBut_1" ng-click="select(pane, false, $index)" class="tabBut_1  tabbut_new" ng-class="{'active':pane.selected}">Ngân hàng</a></li>
              <!-- end ngRepeat: pane in panes -->
              <li ng-repeat="pane in panes" class="ng-scope"><a skip-disable="" tabindex="-1" kv-focus-item="tabBut_2" ng-click="select(pane, false, $index)" class="tabBut_2  tabbut_new" ng-class="{'active':pane.selected}">Tổng quỹ</a></li>
              <!-- end ngRepeat: pane in panes -->
            </ul>
            <div class="tabBg"></div>
            <div ng-transclude="">
              <kv-tab-pane kv-tab-id="1" title="_l.cashflow_Cash" class="ng-scope ng-isolate-scope">
                <div ng-show="selected" ng-transclude="" class=""></div>
              </kv-tab-pane>
              <kv-tab-pane kv-tab-id="2" title="'Ngân hàng'" class="ng-scope ng-isolate-scope">
                <div ng-show="selected" ng-transclude="" class="ng-hide">
                  <aside class="ovh clb mb15 ng-scope"></aside>
                  <h3 class="leftTitle txtTN ng-binding ng-scope" style="margin-left:0">Tài khoản</h3><a ng-click="addBankAccount()" href="javascript:void(0)" class="showhideicon ng-scope" title="Thêm tài khoản" style="top:48px"><i class="fa fa-plus-circle"></i></a>
                  <aside class="boxLeftC ng-scope">
                    <div id="ddlBankAccount"> 
                      <select kendo-drop-down-list="ddlTest" k-ng-model="filter.bankAcctId" k-rebind="accounts" k-data-text-field="'Account'" k-data-value-field="'Id'" k-data-source="accounts" class="bankAcct " k-on-change="bankAccountChanged()" k-options="customOptions"
                      data-role="dropdownlist" style="display: none;">
                         
                      </select>
                       
                      <a class="editBox ng-hide" ng-click="updateBankAccount()" ng-show="filter.bankAcctId.Id !== -1" title="Sửa tài khoản"><i class="fa fa-pencil-square-o"></i></a></div>
                  </aside>
                </div>
              </kv-tab-pane>
              <kv-tab-pane kv-tab-id="3" title="_l.cashflow_TotalFunds" class="ng-scope ng-isolate-scope">
                <div ng-show="selected" ng-transclude="" class="ng-hide"></div>
              </kv-tab-pane>
            </div>
          </div>
        </kv-tabs>
      </article>
    </article>
    <article class="boxLeft uln ">
      <h3 class="leftTitle ng-binding">Tìm kiếm</h3>
      <aside class="boxLeftC">
        <input type="text" ng-model="filter.keywordParam" placeholder="Theo mã phiếu" class="w100 mb10 ng-pristine ng-untouched ng-valid ng-empty" kv-select-text="" ng-blur="filterUpdated()" ng-keyup="$event.keyCode == 13 ? filterUpdated() : null">
        <input type="text" ng-model="filter.description" placeholder="Ghi chú" class="w100 ng-pristine ng-untouched ng-valid ng-empty" kv-select-text="" ng-blur="filterUpdated()" ng-keyup="$event.keyCode == 13 ? filterUpdated() : null">
      </aside>
    </article>
    <article class="boxLeft uln leftStatus ">
      <h3 class="leftTitle cursor ng-binding" ng-click="showStatus = !showStatus">Trạng thái <a class="showhideicon"><i class="fa fa-chevron-circle-up"></i></a></h3>
      <aside class="boxLeftC" ng-hide="showStatus">
        <ul class="pretty-checkbox-mobile">
          <!-- ngRepeat: item in cashflowStatus -->
          <li ng-repeat="item in cashflowStatus" class="ng-scope has-pretty-child">
            <div class="clearfix prettycheckbox labelright  blue">
              <input value="1" type="checkbox" ng-model="item.checked" kv-change="filterUpdated" kv-pretty-check="" kv-data-label="item.value" ng-checked="item.checked" class="ng-pristine ng-untouched ng-valid ng-isolate-scope ng-not-empty" data-label="Đã thanh toán"
              style="display: none;" checked="checked">
              <a href="javascript:void(0)" tabindex="1000007" class="checked"></a>
              <label for="undefined" class="checked">Đã thanh toán</label>
            </div>
          </li>
          <!-- end ngRepeat: item in cashflowStatus -->
          <li ng-repeat="item in cashflowStatus" class="ng-scope has-pretty-child">
            <div class="clearfix prettycheckbox labelright  blue">
              <input value="2" type="checkbox" ng-model="item.checked" kv-change="filterUpdated" kv-pretty-check="" kv-data-label="item.value" ng-checked="item.checked" class="ng-pristine ng-untouched ng-valid ng-isolate-scope ng-empty" data-label="Đã hủy" style="display: none;">
              <a href="javascript:void(0)" tabindex="1000007" class=""></a>
              <label for="undefined" class="">Đã hủy</label>
            </div>
          </li>
          <!-- end ngRepeat: item in cashflowStatus -->
        </ul>
      </aside>
    </article>
    <article class="boxLeft uln ng-hide" ng-show="branches.Data.length>1">
      <h3 class="leftTitle cursor ng-binding" ng-click="showOrderBranch = !showOrderBranch">Chi nhánh <a class="showhideicon"><i class="fa fa-chevron-circle-up"></i></a></h3>
      <aside class="boxLeftC" ng-hide="showOrderBranch">
        <div class="k-widget k-multiselect k-header" unselectable="on" title="" style="">
          <div class="k-multiselect-wrap k-floatwrap" unselectable="on">
            <ul role="listbox" unselectable="on" class="k-reset" id="sortBranch_taglist">
              <li class="k-button ng-scope" unselectable="on"><span unselectable="on">Chi nhánh trung tâm</span><span unselectable="on" class="k-select"><span unselectable="on" class="k-icon k-i-close">delete</span></span>
              </li>
            </ul>
            <input class="k-input" style="width: 25px;" accesskey="" autocomplete="off" role="listbox" aria-expanded="false" tabindex="0" aria-owns="sortBranch_taglist sortBranch_listbox" aria-disabled="false" aria-readonly="false" aria-busy="false" aria-activedescendant="aaa78262-0d9c-4bfc-9b74-6b96d1458a27"><span class="k-icon k-loading k-loading-hidden"></span></div>
          <select k-data-source="branches.Data" k-filter="'contains'" k-ng-model="branchIds" data-placeholder="_l.lblBranchFilterHolder" k-data-text-field="'Name'" k-data-value-field="'Id'"
          k-on-change="filterbyBranch()" id="sortBranch" multiple="multiple" kendo-multi-select="" data-role="multiselect" aria-disabled="false" aria-readonly="false" style="display: none;">
            <option value="30784" selected="selected">Chi nhánh trung tâm</option>
          </select><span style="font-family: Arial, Helvetica, sans-serif; font-size: 13px; font-stretch: normal; font-style: normal; font-weight: normal; letter-spacing: normal; text-transform: none; line-height: 17.03px; position: absolute; visibility: hidden; top: -3333px; left: -3333px;"></span></div>
      </aside>
    </article>
    <article class="boxLeft uln reportsortTime sort-down sortTime">
      <h3 class="leftTitle cursor ng-binding" ng-click="showTimeFilter = !showTimeFilter">Thời gian <a class="showhideicon"><i class="fa fa-chevron-circle-up"></i></a></h3>
      <kv-report-time-filter kv-model="dateFilter" kv-change="filterbyDate" ng-hide="showTimeFilter" kv-alltime="true" class="ng-isolate-scope">
        <aside class="boxLeftC posR">
          <ul id="">
            <li class="reportsort reportsortDateTime has-pretty-child" ng-hide="kvChooseDate">
              <div class="clearfix prettyradio labelright  blue">
                <input type="radio" kv-pretty-check="" name="stime_" id="reportsortDateTimeIpt" value="range" ng-model="kvModel.typeDate" kv-change="filterTimeChangeType" class="ng-pristine ng-untouched ng-valid ng-isolate-scope ng-not-empty" style="display: none;"
                checked="checked">
                <a href="javascript:void(0)" tabindex="1000007" class="checked"></a>
                <label for="reportsortDateTimeIpt" class="checked"></label>
              </div>
              <aside class="sortTime">
                <label class="sortTimeLbl ng-binding" id="reportsortDateTimeLbl" ng-click="sortTimeType('.reportsortDateTime')">Toàn thời gian</label>
                <aside class="sortTimeHeight sortTimeList">
                  <div class="row">
                    <div class="col-md-4 col-sm-4">
                      <h3>Theo ngày và tuần</h3>
                      <ul>
                        <li><a href="javascript:void(0);" ng-click="filterbyRange('today')" class="ng-binding">Hôm nay</a></li>
                        <li><a href="javascript:void(0);" ng-click="filterbyRange('yesterday')" class="ng-binding">Hôm qua</a></li>
                        <li><a href="javascript:void(0);" ng-click="filterbyRange('thisweek')" class="ng-binding">Tuần này</a></li>
                        <li><a href="javascript:void(0);" ng-click="filterbyRange('lastweek')" class="ng-binding">Tuần trước</a></li>
                        <!-- ngIf: !kvBirthday -->
                        <li ng-if="!kvBirthday" class="ng-scope"><a href="javascript:void(0);" ng-click="filterbyRange('7day')" class="ng-binding">7 ngày qua</a></li>
                        <!-- end ngIf: !kvBirthday -->
                      </ul>
                    </div>
                    <div class="col-md-4 col-sm-4">
                      <h3>Theo tháng và quý</h3>
                      <ul>
                        <li><a href="javascript:void(0);" ng-click="filterbyRange('month')" class="ng-binding">Tháng này</a></li>
                        <li><a href="javascript:void(0);" ng-click="filterbyRange('lastmonth')" class="ng-binding">Tháng trước</a></li>
                        <!-- ngIf: !kvBirthday -->
                        <li ng-if="!kvBirthday" class="ng-scope"><a href="javascript:void(0);" ng-click="filterbyRange('monthlunar')" class="ng-binding">Tháng này (Âm lịch)</a></li>
                        <!-- end ngIf: !kvBirthday -->
                        <!-- ngIf: !kvBirthday -->
                        <li ng-if="!kvBirthday" class="ng-scope"><a href="javascript:void(0);" ng-click="filterbyRange('lastmonthlunar')" class="ng-binding">Tháng trước (Âm lịch)</a></li>
                        <!-- end ngIf: !kvBirthday -->
                        <!-- ngIf: !kvBirthday -->
                        <li ng-if="!kvBirthday" class="ng-scope"><a href="javascript:void(0);" ng-click="filterbyRange('30day')" class="ng-binding">30 ngày qua</a></li>
                        <!-- end ngIf: !kvBirthday -->
                        <li><a href="javascript:void(0);" ng-click="filterbyRange('quarter')" class="ng-binding">Quý này</a></li>
                        <li><a href="javascript:void(0);" ng-click="filterbyRange('lastquarter')" class="ng-binding">Quý trước</a></li>
                      </ul>
                    </div>
                    <div class="col-md-4 col-sm-4">
                      <h3>Theo năm</h3>
                      <ul>
                        <!-- ngIf: !kvBirthday -->
                        <li ng-if="!kvBirthday" class="ng-scope"><a href="javascript:void(0);" ng-click="filterbyRange('year')" class="ng-binding">Năm này</a></li>
                        <!-- end ngIf: !kvBirthday -->
                        <!-- ngIf: !kvBirthday -->
                        <li ng-if="!kvBirthday" class="ng-scope"><a href="javascript:void(0);" ng-click="filterbyRange('lastyear')" class="ng-binding">Năm trước</a></li>
                        <!-- end ngIf: !kvBirthday -->
                        <!-- ngIf: !kvBirthday -->
                        <li ng-if="!kvBirthday" class="ng-scope"><a href="javascript:void(0);" ng-click="filterbyRange('yearlunar')" class="ng-binding">Năm này (Âm lịch)</a></li>
                        <!-- end ngIf: !kvBirthday -->
                        <!-- ngIf: !kvBirthday -->
                        <li ng-if="!kvBirthday" class="ng-scope"><a href="javascript:void(0);" ng-click="filterbyRange('lastyearlunar')" class="ng-binding">Năm trước (Âm lịch)</a></li>
                        <!-- end ngIf: !kvBirthday -->
                        <!-- ngIf: kvModel.typeFilter && kvModel.typeFilter == 'common' && (kvAlltime || kvBirthday) -->
                        <li ng-if="kvModel.typeFilter &amp;&amp; kvModel.typeFilter == 'common' &amp;&amp; (kvAlltime || kvBirthday)" class="ng-scope"><a href="javascript:void(0);" ng-click="filterbyRange('alltime')" class="ng-binding">Toàn thời gian</a></li>
                        <!-- end ngIf: kvModel.typeFilter && kvModel.typeFilter == 'common' && (kvAlltime || kvBirthday) -->
                      </ul>
                    </div>
                  </div>
                </aside>
              </aside>
            </li>
            <li class="reportsort reportsortDateTime reportsortDate has-pretty-child ng-hide" ng-show="kvChooseDate">
              <div class="clearfix prettyradio labelright  blue">
                <input type="radio" kv-pretty-check="" name="stime_" id="chooseDate" value="choose" ng-model="kvModel.typeDate" kv-change="filterTimeChangeType" class="ng-pristine ng-untouched ng-valid ng-isolate-scope ng-not-empty" style="display: none;">
                <a href="javascript:void(0)" tabindex="1000007" class=""></a>
                <label for="chooseDate" class=""></label>
              </div>
              <label class="sortTimeLbl ng-binding" id="reportsortDateTimeLbl" ng-click="sortTimeType('.reportsortDateTime')">Chọn ngày</label>
              <aside class="sortTimeHeight sortDateTimeOtherBox fr">
                <div class="row mb5">
                  <div class="col-md-12">
                    <h6 class="ng-binding">Chọn ngày: <span class="ng-binding">03/08/2017</span></h6>
                    <div kendo-calendar="" id="transDate" required="required" kv-max="EndDate" k-max="EndDate" k-rebind="EndDate" k-ng-model="kvModel.TransDate" ng-click="filterByChooseDate()" data-role="calendar" class="k-widget k-calendar">
                      <div class="k-header"><a href="#" role="button" class="k-link k-nav-prev" aria-disabled="false"><span class="k-icon k-i-arrow-w"></span></a><a href="#" role="button" aria-live="assertive" aria-atomic="true" class="k-link k-nav-fast" aria-disabled="false">Tháng Tám 2017</a>
                        <a
                        href="#" role="button" class="k-link k-nav-next k-state-disabled" aria-disabled="true"><span class="k-icon k-i-arrow-e"></span></a>
                      </div>
                      <table tabindex="0" role="grid" class="k-content" cellspacing="0" data-start="2017/6/31" aria-activedescendant="transDate_cell_selected">
                        <thead>
                          <tr role="row">
                            <th scope="col" title="Thứ Hai">H</th>
                            <th scope="col" title="Thứ Ba">B</th>
                            <th scope="col" title="Thứ Tư">T</th>
                            <th scope="col" title="Thứ Năm">N</th>
                            <th scope="col" title="Thứ Sáu">S</th>
                            <th scope="col" title="Thứ Bảy">B</th>
                            <th scope="col" title="Chủ Nhật">C</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr role="row">
                            <td class="k-other-month" role="gridcell"><a tabindex="-1" class="k-link" href="#" data-value="2017/6/31" title="31 Tháng Bảy 2017">31</a></td>
                            <td role="gridcell"><a tabindex="-1" class="k-link" href="#" data-value="2017/7/1" title="01 Tháng Tám 2017">1</a></td>
                            <td role="gridcell"><a tabindex="-1" class="k-link" href="#" data-value="2017/7/2" title="02 Tháng Tám 2017">2</a></td>
                            <td class="k-today" role="gridcell" aria-selected="true" id="transDate_cell_selected"><a tabindex="-1" class="k-link" href="#" data-value="2017/7/3" title="03 Tháng Tám 2017">3</a></td>
                            <td role="gridcell">&nbsp;</td>
                            <td role="gridcell">&nbsp;</td>
                            <td role="gridcell">&nbsp;</td>
                          </tr>
                          <tr role="row">
                            <td role="gridcell">&nbsp;</td>
                            <td role="gridcell">&nbsp;</td>
                            <td role="gridcell">&nbsp;</td>
                            <td role="gridcell">&nbsp;</td>
                            <td role="gridcell">&nbsp;</td>
                            <td role="gridcell">&nbsp;</td>
                            <td role="gridcell">&nbsp;</td>
                          </tr>
                          <tr role="row">
                            <td role="gridcell">&nbsp;</td>
                            <td role="gridcell">&nbsp;</td>
                            <td role="gridcell">&nbsp;</td>
                            <td role="gridcell">&nbsp;</td>
                            <td role="gridcell">&nbsp;</td>
                            <td role="gridcell">&nbsp;</td>
                            <td role="gridcell">&nbsp;</td>
                          </tr>
                          <tr role="row">
                            <td role="gridcell">&nbsp;</td>
                            <td role="gridcell">&nbsp;</td>
                            <td role="gridcell">&nbsp;</td>
                            <td role="gridcell">&nbsp;</td>
                            <td role="gridcell">&nbsp;</td>
                            <td role="gridcell">&nbsp;</td>
                            <td role="gridcell">&nbsp;</td>
                          </tr>
                          <tr role="row">
                            <td role="gridcell">&nbsp;</td>
                            <td role="gridcell">&nbsp;</td>
                            <td role="gridcell">&nbsp;</td>
                            <td role="gridcell">&nbsp;</td>
                            <td role="gridcell">&nbsp;</td>
                            <td role="gridcell">&nbsp;</td>
                            <td role="gridcell">&nbsp;</td>
                          </tr>
                          <tr role="row">
                            <td role="gridcell">&nbsp;</td>
                            <td role="gridcell">&nbsp;</td>
                            <td role="gridcell">&nbsp;</td>
                            <td role="gridcell">&nbsp;</td>
                            <td role="gridcell">&nbsp;</td>
                            <td role="gridcell">&nbsp;</td>
                            <td role="gridcell">&nbsp;</td>
                          </tr>
                        </tbody>
                      </table>
                      <div class="k-footer"><a href="#" class="k-link k-nav-today" title="03 Tháng Tám 2017">03 Tháng Tám 2017</a></div>
                    </div>
                  </div>
                </div>
              </aside>
            </li>
            <li class="reportsort reportsortOther has-pretty-child">
              <div class="clearfix prettyradio labelright  blue">
                <input type="radio" kv-pretty-check="" name="stime_" value="other" id="sortTime" ng-model="kvModel.typeDate" kv-data-label="" kv-change="filterTimeChangeType" class="ng-pristine ng-untouched ng-valid ng-isolate-scope ng-not-empty" style="display: none;">
                <a href="javascript:void(0)" tabindex="1000007" class=""></a>
                <label for="sortTime" class=""></label>
              </div>
              <label class="sortTimeLbl ng-binding" id="reportsortOtherLbl" ng-click="sortTimeType('.reportsortOther')">Lựa chọn khác </label>
              <aside class="sortTimeHeight sortDateTimeOtherBox fr">
                <div class="row mb5">
                  <div class="col-md-6 col-sm-6">
                    <h6 class="ng-binding">Từ ngày: <!-- ngIf: !kvBirthday --><span ng-if="!kvBirthday" class="ng-binding ng-scope">03/08/2017</span><!-- end ngIf: !kvBirthday --><!-- ngIf: kvBirthday --></h6>
                    <div kendo-calendar="" id="fromDate" required="required" kv-max="EndDate" k-max="EndDate" k-rebind="EndDate" k-ng-model="StartDate" data-role="calendar" class="k-widget k-calendar">
                      
                    </div>
                  </div>
                  <div class="col-md-6 col-sm-6">
                    <h6 class="ng-binding">Đến ngày: <!-- ngIf: !kvBirthday --><span ng-if="!kvBirthday" class="ng-binding ng-scope">03/08/2017</span><!-- end ngIf: !kvBirthday --><!-- ngIf: kvBirthday --></h6>
                    <div kendo-calendar="" id="toDate" required="required" kv-min="StartDate" k-min="StartDate" k-rebind="StartDate" k-ng-model="EndDate" data-role="calendar" class="k-widget k-calendar">
                      
                    </div>
                  </div>
                </div>
                <div class="boxBtn mb15 txtR"><a ng-click="filterByDateRange()" class="kv2Btn ng-binding"><i class="fa fa-filter"></i>Tìm kiếm</a></div>
              </aside>
            </li>
          </ul>
        </aside>
      </kv-report-time-filter>
    </article>
    <article class="boxLeft uln hth-hide" ng-show="users.Data.length>1 &amp;&amp; !user.IsLimitedByTrans">
      <h3 class="leftTitle cursor ng-binding" ng-click="showOrderCreatedBy = !showOrderCreatedBy">Người tạo <a class="showhideicon"><i class="fa fa-chevron-circle-up"></i></a></h3>
      <aside class="boxLeftC" ng-hide="showOrderCreatedBy">
        <div class="k-widget k-multiselect k-header" unselectable="on" title="" style="">
          <div class="k-multiselect-wrap k-floatwrap" unselectable="on">
            <ul role="listbox" unselectable="on" class="k-reset" id="sortBranch_taglist"></ul>
            <input class="k-input k-readonly" style="width: 116px;" accesskey="" autocomplete="off" role="listbox" aria-expanded="false" tabindex="0" aria-owns="sortBranch_taglist sortBranch_listbox" aria-disabled="false" aria-readonly="false" aria-busy="false"
            aria-activedescendant="d5b9ad14-7f65-44d0-bc94-595cb97c8010"><span class="k-icon k-loading k-loading-hidden"></span></div>
          <select k-data-source="users.Data" k-ng-model="userIds" data-placeholder="_l.lblCreatedByFilterHolder" k-data-text-field="'UserName'" k-data-value-field="'Id'" k-on-change="filterbyCreatedBy()"
          id="sortBranch" multiple="multiple" kendo-multi-select="" data-role="multiselect" aria-disabled="false" aria-readonly="false" style="display: none;">
            <option value="92514">nhanvien01</option>
            <option value="92515">nhanvien02</option>
            <option value="92513">0916863458</option>
          </select><span style="font-family: Arial, Helvetica, sans-serif; font-size: 13px; font-stretch: normal; font-style: normal; font-weight: normal; letter-spacing: normal; text-transform: none; line-height: 17.03px; position: absolute; visibility: hidden; top: -3333px; left: -3333px;">Chọn người tạo</span></div>
      </aside>
    </article>
    <article class="boxLeft uln hth-hide">
      <h3 class="leftTitle cursor ng-binding" ng-click="showPartnerFilter = !showPartnerFilter">Người nộp/nhận<a class="showhideicon"><i class="fa fa-chevron-circle-up"></i></a></h3>
      <aside class="boxLeftC" ng-hide="showPartnerFilter"><span title="" class="k-widget k-dropdown k-header mb10 w100" unselectable="on" role="listbox" aria-haspopup="true" aria-expanded="false" tabindex="0" aria-owns="" aria-disabled="false" aria-readonly="false" aria-busy="false" style="" aria-activedescendant="6ee304ed-bc51-4de7-a7da-81cabd28138c"><span unselectable="on" class="k-dropdown-wrap k-state-default"><span unselectable="on" class="k-input ng-scope">Tất cả</span>
        <span
        unselectable="on" class="k-select"><span unselectable="on" class="k-icon k-i-arrow-s">select</span></span>
          </span>
          <select k-data-source="dsPartnerType" k-data-text-field="'Name'" k-data-value-field="'Value'" k-on-change="filterByPartnerType()" k-ng-model="parentType" kendo-drop-down-list="" class="mb10 w100" data-role="dropdownlist" style="display: none;">
            <option value="A" selected="selected">Tất cả</option>
            <option value="C">Khách hàng</option>
            <option value="S">Nhà cung cấp</option>
            <option value="U">Nhân viên</option>
            <option value="D">Đối tác giao hàng</option>
            <option value="O">Khác</option>
          </select>
          </span>
          <input type="text" ng-model="filter.partnerName" placeholder="Tên người nộp/nhận" class="w100 mb10 ng-pristine ng-untouched ng-valid ng-empty" kv-select-text="" ng-blur="filterUpdated()" ng-keyup="$event.keyCode == 13 ? filterUpdated() : null">
          <input type="text" ng-model="filter.partnerTelephone" placeholder="Điện thoại" class="w100 ng-pristine ng-untouched ng-valid ng-empty" kv-select-text="" ng-blur="filterUpdated()" ng-keyup="$event.keyCode == 13 ? filterUpdated() : null">
      </aside>
    </article>
    <article class="boxLeft uln hth-hide">
      <h3 class="leftTitle cursor ng-binding" ng-click="showCashGroup = !showCashGroup">Loại thu chi <a class="showhideicon"><i class="fa fa-chevron-circle-up"></i></a></h3>
      <aside class="boxLeftC" ng-hide="showCashGroup">
        <div class="k-widget k-multiselect k-header" unselectable="on" title="" style="">
          <div class="k-multiselect-wrap k-floatwrap" unselectable="on">
            <ul role="listbox" unselectable="on" class="k-reset" id="sortGroup_taglist"></ul>
            <input class="k-input k-readonly" style="width: 92px;" accesskey="" autocomplete="off" role="listbox" aria-expanded="false" tabindex="0" aria-owns="sortGroup_taglist sortGroup_listbox" aria-disabled="false" aria-readonly="false" aria-busy="false"
            aria-activedescendant="5e894316-f7cd-4bb4-b98e-a371d415f9cc"><span class="k-icon k-loading k-loading-hidden"></span></div>
          <select id="sortGroup" multiple="multiple" kendo-multi-select="" k-data-source="groups.Data" k-ng-model="groupIds" data-placeholder="_l.cashflow_filterByGroup" k-data-text-field="'Name'"
          k-on-change="filterbyGroup()" data-role="multiselect" aria-disabled="false" aria-readonly="false" style="display: none;">
            <option value="[object Object]">Thu chi khác</option>
            <option value="[object Object]">Tiền hàng</option>
          </select><span style="font-family: Arial, Helvetica, sans-serif; font-size: 13px; font-stretch: normal; font-style: normal; font-weight: normal; letter-spacing: normal; text-transform: none; line-height: 17.03px; position: absolute; visibility: hidden; top: -3333px; left: -3333px;">Loại thu chi</span></div>
      </aside>
    </article>
    <article class="boxLeft leftStatus uln  ">
      <h3 class="leftTitle cursor ng-binding" ng-click="showCashType = !showCashType">Loại chứng từ <a class="showhideicon"><i class="fa fa-chevron-circle-up"></i></a></h3>
      <aside class="boxLeftC" ng-hide="showCashType">
        <ul class="pretty-checkbox-mobile">
          <!-- ngRepeat: item in cashflowType -->
          <li ng-repeat="item in cashflowType" class="ng-scope has-pretty-child">
            <div class="clearfix prettycheckbox labelright  blue">
              <input value="1" type="checkbox" ng-model="item.type" kv-change="inOutChanged" kv-pretty-check="" kv-data-label="item.label" class="ng-pristine ng-untouched ng-valid ng-isolate-scope ng-empty" data-label="Phiếu thu" style="display: none;" checked="checked" />
              <a href="javascript:void(0)" tabindex="1000007" class="checked"></a>
              <label for="undefined" class="">Phiếu thu</label>
            </div>
          </li>
          <!-- end ngRepeat: item in cashflowType -->
          <li ng-repeat="item in cashflowType" class="ng-scope has-pretty-child">
            <div class="clearfix prettycheckbox labelright  blue">
              <input value="2" type="checkbox" ng-model="item.type" kv-change="inOutChanged" kv-pretty-check="" kv-data-label="item.label" class="ng-pristine ng-untouched ng-valid ng-isolate-scope ng-empty" data-label="Phiếu chi" style="display: none;" checked="checked" />
              <a href="javascript:void(0)" tabindex="1000007" class="checked"></a>
              <label for="undefined" class="">Phiếu chi</label>
            </div>
          </li>
          <!-- end ngRepeat: item in cashflowType -->
        </ul>
      </aside>
    </article>
    <article class="boxLeft leftStatus uln  ">
      <h3 class="leftTitle cursor ng-binding" ng-click="showPerformanceResult = !showPerformanceResult">Kết quả Kinh Doanh <a class="showhideicon"><i class="fa fa-chevron-circle-up"></i></a></h3>
      <aside class="boxLeftC" ng-hide="showPerformanceResult">
        <ul class="pretty-radio-mobile">
          <li class="has-pretty-child">
            <div class="clearfix prettyradio labelright  blue">
              <input value="1" type="radio" ng-model="financialFilter" value="include" name="sFinancial" kv-change="filterbyFinancial" kv-pretty-check="" kv-data-label="_l.recorded" class="ng-pristine ng-untouched ng-valid ng-isolate-scope ng-not-empty" data-label="Đưa vào hạch toán"
              style="display: none;">
              <a href="javascript:void(0)" tabindex="1000007" class=""></a>
              <label for="undefined" class="">Đưa vào hạch toán</label>
            </div>
          </li>
          <li class="has-pretty-child">
            <div class="clearfix prettyradio labelright  blue">
              <input value="0" type="radio" ng-model="financialFilter" value="exclude" name="sFinancial" kv-change="filterbyFinancial" kv-pretty-check="" kv-data-label="_l.notrecorded" class="ng-pristine ng-untouched ng-valid ng-isolate-scope ng-not-empty" data-label="Không hạch toán"
              style="display: none;">
              <a href="javascript:void(0)" tabindex="1000007" class=""></a>
              <label for="undefined" class="">Không hạch toán</label>
            </div>
          </li>
          <li class="has-pretty-child">
            <div class="clearfix prettyradio labelright  blue">
              <input value="-1" type="radio" ng-model="financialFilter" value="all" name="sFinancial" kv-change="filterbyFinancial" kv-pretty-check="" kv-data-label="_l.saleTable_All" class="ng-pristine ng-untouched ng-valid ng-isolate-scope ng-not-empty" data-label="Tất cả"
              style="display: none;" checked="checked">
              <a href="javascript:void(0)" tabindex="1000007" class="checked"></a>
              <label for="undefined" class="checked">Tất cả</label>
            </div>
          </li>
        </ul>
      </aside>
    </article>
    <article class="boxLeft reportHide uln sortTime sortView">
      <h3 class="leftTitle cursor ng-binding">Lựa chọn hiển thị</h3>
      <aside class="boxLeftC">
        <aside class="ng-binding">Số bản ghi:<span title="" class="k-widget k-dropdown k-header" unselectable="on" role="listbox" aria-haspopup="true" aria-expanded="false" tabindex="0" aria-owns="mainView_listbox" aria-disabled="false" aria-readonly="false" aria-busy="false"
          aria-activedescendant="ab6caac5-2c95-41f0-9be2-30ff1b4e25fe" style=""><span unselectable="on" class="k-dropdown-wrap k-state-default"><span unselectable="on" class="k-input ng-scope">10</span><span unselectable="on" class="k-select"><span unselectable="on" class="k-icon k-i-arrow-s">select</span></span>
          </span>
          <select id="mainView" k-ng-model="pageSize" k-change="refresh" k-data-source="pageSizes" k-value-primitive="true" kendo-drop-down-list="" data-role="dropdownlist" style="display: none;">
            <option value="10" selected="selected">10</option>
            <option value="15">15</option>
            <option value="20">20</option>
            <option value="30">30</option>
            <option value="50">50</option>
          </select>
          </span>
        </aside>
      </aside>
    </article>
  </div>
  <div class="wrap-button-footer">
    <button kv-mobile="" type="button" class="kv2Btn">Hoàn tất</button>
  </div>
</section>


 
<section class="mainRight ng-scope">
    <section class="mainWrap fll w100" style="position: relative; top: auto; bottom: auto; width: auto;">
        <article class="headerContent uln fll w100">
            <h1><a href="javascript:void(0);" class="mobileIcon" kv-mobile=""></a><span class="ng-binding">Sổ quỹ tiền mặt</span></h1>
            
            <aside class="flr">
                <a href="javascript:void(0)" class="kv2Btn ng-binding" onclick="createItem()" ng-hide="CashFlowType == 3 ? true : false"><i class="fa fa-plus"></i> Lập phiếu thu</a>
                <a href="javascript:void(0)" class="kv2Btn ng-binding" onclick="createItem(true)" ng-hide="CashFlowType == 3 ? true : false"><i class="fa fa-plus"></i> Lập phiếu chi</a>
                <div class="addProductBtn hide-mobile-tablet"><a class="kv2Btn kv2BtnExport ng-binding" title="Xuất  file"><i class="fa fa-sign-out"></i> Xuất  file <i class="fa fa-caret-down"></i></a><ul><li><a kv-taga-disabled="invoices.total()==0" ng-click="export()" class="ng-binding"><i class="fa fa-share"></i> File tổng quan</a></li><li><a kv-taga-disabled="invoices.total()==0" ng-click="exportDetail()" class="ng-binding"><i class="fa fa-share-square-o"></i> File chi tiết</a></li></ul></div>
                <div id="columnSelection" kv-column-selection="" class="hth-hide columnView k-widget k-reset k-header k-menu k-menu-horizontal" binded-grid="bindedGrid" title="Tùy chọn" data-role="menu" tabindex="0" role="menubar" aria-activedescendant="columnSelection_mn_active"><li class="k-item k-state-default k-first k-last" role="menuitem" aria-haspopup="true" id="columnSelection_mn_active"><span class="k-link"><span class="k-icon k-i-arrow-s"></span></span><ul class="k-group k-menu-group" style="display:none" role="menu" aria-hidden="true"><li class="k-item k-state-default k-first" role="menuitem"><span class="k-link"><label title=" " class="quickaction_chk dpb undefined"><input type="checkbox" checked="checked" class="check_row" data-field="Code"><span></span>Mã nhập hàng</label></span></li><li class="k-item k-state-default" role="menuitem"><span class="k-link"><label title=" " class="quickaction_chk dpb undefined"><input type="checkbox" checked="checked" class="check_row" data-field="PurchaseDate"><span></span>Thời gian</label></span></li><li class="k-item k-state-default" role="menuitem"><span class="k-link"><label title=" " class="quickaction_chk dpb undefined"><input type="checkbox" checked="checked" class="check_row" data-field="ModifiedDate"><span></span>Ngày cập nhật</label></span></li><li class="k-item k-state-default" role="menuitem"><span class="k-link"><label title=" " class="quickaction_chk dpb undefined"><input type="checkbox" checked="checked" class="check_row" data-field="Supplier.Name"><span></span>Nhà cung cấp</label></span></li><li class="k-item k-state-default" role="menuitem"><span class="k-link"><label title=" " class="quickaction_chk dpb undefined"><input type="checkbox" checked="checked" class="check_row" data-field="Branch.Name"><span></span>Chi nhánh</label></span></li><li class="k-item k-state-default" role="menuitem"><span class="k-link"><label title=" " class="quickaction_chk dpb undefined"><input type="checkbox" checked="checked" class="check_row" data-field="User.GivenName"><span></span>Người nhập</label></span></li><li class="k-item k-state-default" role="menuitem"><span class="k-link"><label title=" " class="quickaction_chk dpb undefined"><input type="checkbox" checked="checked" class="check_row" data-field="User1.GivenName"><span></span>Người tạo</label></span></li><li class="k-item k-state-default" role="menuitem"><span class="k-link"><label title=" " class="quickaction_chk dpb undefined"><input type="checkbox" checked="checked" class="check_row" data-field="SubTotal"><span></span>Tổng tiền hàng</label></span></li><li class="k-item k-state-default" role="menuitem"><span class="k-link"><label title=" " class="quickaction_chk dpb undefined"><input type="checkbox" checked="checked" class="check_row" data-field="Discount"><span></span>Giảm giá</label></span></li><li class="k-item k-state-default" role="menuitem"><span class="k-link"><label title=" " class="quickaction_chk dpb undefined"><input type="checkbox" checked="checked" class="check_row" data-field="Total"><span></span>Tổng cộng</label></span></li><li class="k-item k-state-default" role="menuitem"><span class="k-link"><label title=" " class="quickaction_chk dpb undefined"><input type="checkbox" checked="checked" class="check_row" data-field="PaidAmount"><span></span>Tiền đã trả NCC</label></span></li><li class="k-item k-state-default" role="menuitem"><span class="k-link"><label title=" " class="quickaction_chk dpb undefined"><input type="checkbox" checked="checked" class="check_row" data-field="ShortDescription"><span></span>Ghi chú</label></span></li><li class="k-item k-state-default k-last" role="menuitem"><span class="k-link"><label title=" " class="quickaction_chk dpb undefined"><input type="checkbox" checked="checked" class="check_row" data-field="Status"><span></span>Trạng thái</label></span></li></ul></li></div>
            </aside>

        </article>
        <article class="ovh uln clb cashTop" ng-show="IsViewSumTop">
          <ul>
            <li ng-show="!user.IsLimitedByTrans">
              <h3 class="ng-binding">Quỹ đầu kỳ</h3><font color="darkcyan" class="ng-binding">0</font></li>
            <li>
              <h3 class="ng-binding">Tổng thu</h3><font color="#0e83ad" class="ng-binding">0</font></li>
            <li>
              <h3 class="ng-binding">Tổng chi</h3><font color="#c20303" class="ng-binding">-0</font></li>
            <li ng-show="!user.IsLimitedByTrans" class="nowrap">
              <h3 class="ng-binding">Tồn quỹ<a href="javascript:void(0)" tabindex="0" class="help icon" kv-tooltip="" data-toggle="tooltip" data-placement="left" data-original-title="Tồn quỹ = Quỹ đầu kỳ + Tổng thu - Tổng chi"><i class="fa fa-info-circle"></i></a></h3><font color="#4f9e00" class="ng-binding">0</font></li>
          </ul>
        </article>

        <article class="clb k-gridNone k-grid-Scroll">
            <div id="grdBranchs" kendo-grid="" k-data-source="branches" k-sortable="true" k-resizable="true" k-selectable="true"  kv-grid-expan-row="" k-data-bound="emptyGridFix" k-data-binding="grvdataBinding" data-title="branch_Paging" k-detail-template="detailTemplate" k-detail-init="grvDetailInit" k-detail-expand="grvDetailExpand" data-role="grid" class="k-grid k-widget">
            <div class="k-grid-header" style="padding-right: 17px;">
            <div class="k-grid-header-wrap k-auto-scrollable" data-role="resizable">
            <table role="grid">
            <colgroup>
            <col class="k-hierarchy-col"><col><col><col><col><col> </colgroup>
            <thead role="rowgroup">
            <tr role="row">
            <th class="k-hierarchy-cell k-header ng-scope" scope="col">&nbsp;</th>
            <th scope="col" role="columnheader" data-field="Name" rowspan="1" data-title="Mã phiếu" data-index="0" id="e7e15aa7-161b-4807-9721-da9a9abb94b7" class="tdCode18 k-header ng-scope" data-role="columnsorter">
            <a class="k-link" href="javascript:void(0);">Mã phiếu</a></th>
            <th scope="col" role="columnheader" data-field="Address" rowspan="1" data-title="Thời gian" data-index="1" id="c563cae7-3a18-4aba-a53d-621035a98943" class="tdDateTime k-header ng-scope" data-role="columnsorter">
            <a class="k-link" href="javascript:void(0);">Thời gian</a></th>            
            <th scope="col" role="columnheader" data-field="ContactNumber" rowspan="1" data-title="Loại thu chi" data-index="2" id="8977b66a-0c78-45b4-bdb5-91403756d56a" class="tdCode16 k-header ng-scope" data-role="columnsorter">
            <a class="k-link" href="javascript:void(0);">Loại thu chi</a></th>
            
            <th scope="col" role="columnheader" data-field="ContactNumber" rowspan="1" data-title="Tổng cộng" data-index="3" class="tdMin k-header ng-scope" data-role="columnsorter">
            <a class="k-link" href="javascript:void(0);">Người nộp/nhận</a></th> 
            <th scope="col" role="columnheader" data-field="ContactNumber" rowspan="1" data-title="Trạng thái" data-index="4" class="tdStatus k-header ng-scope" data-role="columnsorter">
            <a class="k-link" href="javascript:void(0);">Giá trị</a></th> 
             
            </tr>
            
            </thead>
            </table>
            </div></div>
            <div class="k-grid-content k-auto-scrollable">
            <table role="treegrid" data-role="selectable" class="k-selectable">
            <colgroup><col class="k-hierarchy-col"><col><col><col><col><col></colgroup>
            <tbody role="rowgroup">
             
            </tbody></table></div>
            <div class="paging-box" style="display: block;">
            <div class="k-pager-wrap k-grid-pager k-widget k-floatwrap" data-role="pager">
            <a href="javascript:void(0);" title="Trang đầu" class="k-link k-pager-nav k-pager-first k-state-disabled" data-page="1" tabindex="-1">
            <span class="k-icon k-i-seek-w">Trang đầu</span></a>
            <a href="javascript:void(0);" title="Trang trước" class="k-link k-pager-nav  k-state-disabled" data-page="1" tabindex="-1">
            <span class="k-icon k-i-arrow-w">Trang trước</span></a>
            
            <ul class="k-pager-numbers k-reset">
            <li class="k-current-page"><span class="k-link k-pager-nav">1</span></li>
            <li><span class="k-state-selected">1</span></li>
            </ul>
            
            <a href="javascript:void(0);" title="Trang sau" class="k-link k-pager-nav  k-state-disabled" data-page="1" tabindex="-1">
            <span class="k-icon k-i-arrow-e">Trang sau</span></a>
            
            <a href="javascript:void(0);" title="Trang cuối" class="k-link k-pager-nav k-pager-last k-state-disabled" data-page="1" tabindex="-1">
            <span class="k-icon k-i-seek-e">Trang cuối</span></a>
            
            <span class="k-pager-info k-label">Hiển thị 0 - 0 trên tổng số 0 phiếu thu/chi</span>
            </div>
            </div>
            </div>
        </article>
        <div style="display: none">
        
        <script type="text/x-kendo-template" id="templUsersInBranch">
        <tr class="{{dataItem.class}}" data-uid="{{dataItem.class}}" role="row">
                                <td class="" role="gridcell"><a href="/#/Users?Code={{dataItem.username}}" target="_blank">{{dataItem.name}}</a></td>
                                <td class="tdBranch" role="gridcell">{{dataItem.username}}</td>
                                <td class="tdBranch" role="gridcell">{{dataItem.role}}</td>
                                </tr>
        </script>
        <script type="text/x-kendo-template" id="templBranch">
        <tr class="{{dataItem.class}} k-master-row ng-scope" data-uid="{{dataItem.id}}" role="row">
            <td class="k-hierarchy-cell"><a class="k-icon k-plus" href="javascript:void(0);" tabindex="-1"></a></td>
            <td class="tdCode18" role="gridcell"><span ng-bind="dataItem.code" class="ng-binding">{{dataItem.code}}</span></td>
            <td class="tdDateTime" role="gridcell"><span ng-bind="dataItem.date" class="ng-binding">{{dataItem.date|xdate}}</span></td>
            <td class="tdCode16" role="gridcell"><span ng-bind="dataItem.customer" class="ng-binding">{{(dataItem.type==8||dataItem.type==9)?(dataItem.cashflowtype>0?loadObject(dataItem.cashflowtype,bill_types).name:'Thu nhập khác'):loaihds[dataItem.type][0]}}</span></td>
            <td class="tdMin" role="gridcell"><span ng-bind="dataItem.price" class="ng-binding">{{eval("load"+loaihds[dataItem.type][1].capitalizeOne()+"(dataItem."+loaihds[dataItem.type][1]+",dataItem.partnertype).name")}}</span></td>
            <td class="tdStatus" role="gridcell"><span ng-bind="dataItem.discount" class="ng-binding"{{dataItem.status==1?'':' style="color:red"'}}>{{((dataItem.type==9||dataItem.type==8)?dataItem.price:dataItem.paying)*(loaihds[dataItem.type][2]==2?-1:1)}}</span></td>
             
        </tr>
        </script>
        <script type="text/x-kendo-template" id="templProductInvoice">
        <tr class="{{$i%2==1?'k-alt':''}}" data-uid="48d7cae0-e12d-4216-9e1e-bc378e3abc0e" role="row">
          <td class="tdCode" role="gridcell">{{loadProduct(row.product).code}}</td>
          <td class="tdNone" role="gridcell">{{loadProduct(row.product).name}}<span class="txtN txtI dpb fs11 txtGray">{{loadProduct(row.product).uname}}</span></td>
          <td class="tdSLB txtR" role="gridcell">{{row.quantity}}</td>
          <td class="tdPrice" role="gridcell">{{row.price|formatCurrency}}</td>
          <td class="tdSLB txtR" role="gridcell">{{row.discount|formatCurrency}}</td>
          <td class="tdTotal txtB" role="gridcell">{{(row.price-row.discount)*row.quantity|formatCurrency}}</td>
        </tr>
        </script>
        <script type="text/x-kendo-template" id="templBranchDetail">
              <tr class="k-detail-row ng-scope"><td class="k-hierarchy-cell"></td><td class="k-detail-cell" colspan="5">
            <div class="k-tabstrip-wrapper" style="width: 100%;"><div class="tabstrip k-widget k-header k-tabstrip k-floatwrap k-tabstrip-top" data-role="tabstrip" tabindex="0" role="tablist">
                <ul class="k-tabstrip-items k-reset"><li class="ng-binding k-item k-state-default k-first k-tab-on-top k-state-active" role="tab" aria-controls="94d774af-95d8-4e54-8236-90c4197cd28b-1" aria-selected="true"><span class="k-loading k-complete"></span><span class="k-link">Thông tin</span></li>
                <li id="tabInventory" class="ng-binding k-item k-state-default k-last k-state-hover hth-hide" role="tab" aria-controls="94d774af-95d8-4e54-8236-90c4197cd28b-2"><span class="k-loading k-complete"></span><span class="k-link">Lịch sử thanh toán</span></li></ul>
                <div class="k-content k-state-active" id="94d774af-95d8-4e54-8236-90c4197cd28b-1" role="tabpanel" aria-expanded="true" style="display: block;">
            <invoice-form kv-data-item="dataItem" kv-on-save="refresh" kv-surcharges="surcharges" class="ng-isolate-scope">
              <div class="form-wrapper form-labels-90 content-list">
                <div class="row row-padding-15">
                  <div class="col-md-4 col-sm-6">
                    <div class="form-group">
                      <label class="form-label control-label ng-binding">Mã phiếu:</label>
                      <div class="form-wrap form-control-static"><strong><a ng-click="viewCashflowItem(dataItem)" class="ng-binding">{{dataItem.code}}</a></strong></div>
                    </div>
                     
                    <div class="form-group">
                      <label class="form-label control-label ng-binding">Thời gian:</label>
                      <div class="form-wrap form-control-static ng-binding">{{dataItem.date|xdate}}</div>
                    </div>
                    <div class="form-group">
                      <label class="form-label control-label ng-binding">Nhóm người {{loaihds[dataItem.type][2]==2?'nhận':'nộp'}}:</label>
                      <div class="form-wrap form-control-static ng-binding">{{dataItem.type==8||dataItem.type==9?typehds[dataItem.partnertype]:typehds[loaihds[dataItem.type][3]]}}</div>
                    </div>
                    <div class="form-group">
                      <label class="form-label control-label ng-binding">Tên người {{loaihds[dataItem.type][2]==2?'nhận':'nộp'}}:</label>
                      <div class="form-wrap form-control-static ng-binding">{{eval("load"+loaihds[dataItem.type][1].capitalizeOne()+"(dataItem."+loaihds[dataItem.type][1]+",dataItem.partnertype).name")}}</div>
                    </div>
                    <div class="form-group{{(dataItem.payment==1||dataItem.payment==2)?'':' ng-hide'}}">
                      <label class="form-label control-label ng-binding">Tài khoản nhận:</label>
                      <div class="form-wrap form-control-static ng-binding">{{((dataItem.payment==1||dataItem.payment==2)&&dataItem.extra>0)?loadObject(dataItem.extra,bankaccounts).account:''}}</div>
                    </div>
                  </div>
                  <div class="col-md-4 col-sm-6">
                    <div class="form-group">
                      <label class="form-label control-label ng-binding">Trạng thái:</label>
                       
                      <div class="form-wrap form-control-static ng-binding" ng-show="disabled || hasIssued">{{dataItem.status==1?'Đã thanh toán':'Đã hủy'}}</div>
                    </div>
                     
                    <div class="form-group">
                      <label class="form-label control-label ng-binding">Chi nhánh:</label>
                      <div class="form-wrap form-control-static"><span ng-bind="dataItem.BranchName" class="txtBranch ng-binding">{{loadBranch(dataItem.branch).name}}</span></div>
                    </div>
                    
                    <div class="form-group">
                      <label class="form-label control-label ng-binding">Giá trị:</label>
                      <div class="form-wrap form-control-static ng-binding">{{(loaihds[dataItem.type][2]==2?-1:1)*dataItem.paying}}</div>
                    </div>
                    
                    <div class="form-group">
                      <label class="form-label control-label ng-binding">Loại thu chi:</label>
                      <div class="form-wrap form-control-static ng-binding">{{(dataItem.type==8||dataItem.type==9)?(dataItem.cashflowtype>0?loadObject(dataItem.cashflowtype,bill_types).name:'Thu nhập khác'):loaihds[dataItem.type][0]}}</div>
                    </div>
                    <div class="form-group">
                      <label class="form-label control-label ng-binding">Người tạo:</label>
                      <div class="form-wrap form-control-static ng-binding">{{loadUser(dataItem.create).name}}</div>
                    </div>
                    
                  </div>
                  <div class="col-md-4 col-sm-12">
                    <div ng-modal="dataItem.Description" ng-bind="dataItem.Description?dataItem.Description:'Ghi chú...'" ng-show="disabled" class="tblBox_Des tblBox_Des2 ng-binding ng-hide">Ghi chú...</div>
                    <textarea maxlength="4000" ng-model="dataItem.Description" placeholder="Ghi chú..." ng-show="!disabled" ng-disabled="disabled" class="tblBox_Des tblBox_Des2 ng-pristine ng-untouched ng-valid ng-empty ng-valid-maxlength" kv-textarea-enter="">{{dataItem.note}}</textarea>
                  </div>
                </div>
              </div>
               
            
            
          <div class="kv-group-btn">
          <span ng-show="!noteditable">
              
          <a ng-click="openTransaction(dataItem)" ng-show="hasFinish" class="kv2Btn ng-binding"><i class="fa fa-share"></i> Mở phiếu</a>
          <a ng-click="printContent()" class="kv2Btn kv2BtnYellow ng-binding"><i class="fa fa-print"></i> In</a> </span>   </div>
            
            

        </invoice-form>

                </div>
                 


            </div></div>

        </td></tr>


            </script>
  

        </div>
    </section>
</section>


    <script>
    var filter = {
        status: [1],
        type:[1,2],
        financialFilter:-1,
        keywordParam:'',
        description:'',
        range:'',
        bankAccId:'',
    }
        cpage=0
        var partnerSearchTempl
        var bill_types = cache_invoices.getItem("bill_types");
        var partners = cache_invoices.getItem("partners");
        
        var invoices = cache_invoices.getItem("cashflows");
        var item;
        
        function loadPartner(i,partnertype){
            switch(parseInt(partnertype)){                                
                case 1:
                return loadCustomer(i)
                break
                case 2:
                return loadSupplier(i)
                break
                case 3:
                return loadUser(i)
                break
                default:
                case 0:
                return loadObject(i,partners)
                break
            }
            
        }
       
        function loadJsonBillTypes(lo){
            console.log('loadJsonBillTypes');
            $.getJSON( "ajax.php?action=bill_types", function( data ) {
                  bill_types = data;
                  saveCacheBillTypes()
                   if(lo!=undefined) lo.call();
                });
        } 
        function saveCacheBillTypes(){
			try{
            cache_invoices.setItem("bill_types",bill_types,{expirationAbsolute: null,
                     expirationSliding: 3600,
                     priority: Cache.Priority.HIGH,
                     callback: function(k, v) { console.log('Cache removed: ' + k); }
                    });
			}catch(e){console.log('Save cache error')}			
        }
        function loadJsonPartners(lo){
            console.log('loadJsonPartners');			
            $.getJSON( "ajax.php?action=partners&branch="+cb, function( data ) {
                  partners = data;
                  saveCachePartners()
                   if(lo!=undefined) lo.call();
                });
        } 
        function saveCachePartners(){
			try{
            cache_invoices.setItem("partners",partners,{expirationAbsolute: null,
                     expirationSliding: 3600,
                     priority: Cache.Priority.HIGH,
                     callback: function(k, v) { console.log('Cache removed: ' + k); }
                    });
			}catch(e){console.log('Save cache error')}		
        }
        loadJsonBillTypes()
        loadJsonPartners() 
     
        function loadInvoice(pid){
            return loadObject(pid, invoices);
        }
        
        loadJsonInvoices_cashflows(br)
        
        if(!users) loadJsonUsers( );
         
        if(!tables) loadJsonTables()
        
        function br(){
            loadTableLeft();
        }
        
        function oBlur(d){ console.log('oBlur')
            var i = $(d).attr('ng-model').slice(7)
            filter[i] = $(d).val().trim()
            cpage = 0
            loadTables()
        }
        
        function filterByDateRange(){ //alert(_range)
            
            filter.range = _range.join('-')
            $('#reportsortOtherLbl').html(filter.range)
            cpage = 0
            loadTables()
            
            hide2()
        }
        
        var _range = [],CashFlowType=0,_CashFlowType=['Sổ quỹ tiền mặt','Sổ quỹ ngân hàng','Tổng quỹ'];
         
        function loadTableLeft(){
            
            $('section.mainWrap article.headerContent span.ng-binding').html(_CashFlowType[CashFlowType])
            
            var loadDef = function(){
                $('.k-window-cashflowbank [ng-model]').val('')
                $('.k-window-cashflowbank [k-ng-model]').val('')
                $('.k-window-cashflowbank select option').removeAttr('selected')
                $('.k-window-cashflowbank .k-dropdown .k-input').html('---Chọn ngân hàng---')
            }
            
            $('[ng-click="updateBankAccount()"]').unbind('click')
            $('[ng-click="updateBankAccount()"]').click(function(){
                if(filter.bankAccId=='') return false
                
                var x = loadObject(filter.bankAccId,bankaccounts)
                //loadDef()
                $('.k-window-cashflowbank [ng-model="account.Bank"]').val(x.bank)
                $('.k-window-cashflowbank [ng-model="account.Account"]').val(x.account)
                $('.k-window-cashflowbank [ng-model="account.Branch"]').val(x.branch)
                $('.k-window-cashflowbank [ng-model="account.AccountName"]').val(x.accountname)
                $('.k-window-cashflowbank [ng-model="account.Description"]').val(x.description)
                $('[k-ng-model="model.BankCode"]').select3('destroy')
                $('[k-ng-model="model.BankCode"]').select3({
                    sources: banks,
                    empty: '---Chọn ngân hàng---',
                    width: '100%',
                    emptyValue: '',
                    selected: x.bankcode
                })
                
                $('.k-window-cashflowbank').show()
                $('.main>.k-overlay').css({
                    display:'block'                     
                })
                
                $('.k-window-cashflowbank .k-icon.k-i-close').unbind('click')
                $('.k-window-cashflowbank .k-icon.k-i-close').click(function(){
                    $('.k-window-cashflowbank').hide()
                    $('.main>.k-overlay').css({
                        display:'none'                     
                    })
                    return false;
                })
                
                $('[ng-click="saveAccount()"]').unbind('click')
                $('[ng-click="saveAccount()"]').click(function(){
                    var x=_serialize('[kendo-window="bankWindow"]',[0,1,2,3,4])
                    if(x==''){
                        toastr.warning('Hãy điền hết các thông tin cơ bản')
                        return false
                    }
                    x = parse_str(decodeURIComponent(x))                     
                    x = toLowserCaseObjectKeys(x)
                    x.id = filter.bankAccId
                    $.ajax('ajax.php?action=bankaccount',{
                        data: x,
                        method: "POST",
                        dataType: 'json',
                        success: function(d){
                             //console.log(d)
                             if(d.error){
                                 toastr.warning('Có lỗi xảy ra')
                             }else{ 
                                 $('.k-window-cashflowbank .k-i-close').click()
                                  
                                 var ob = $.extend({},x)
                                 for(var q in bankaccounts){
                                    if(bankaccounts[q].id==ob.id){
                                        bankaccounts[q] = ob
                                        break;
                                    }
                                 }
                                 saveBankAccount()
                                 
                                 $('[k-ng-model="filter.bankAcctId"]').select3('destroy')         
                                 $('[k-ng-model="filter.bankAcctId"]').select3({
                                    sources: bankaccounts,
                                    empty: '---Chọn---',
                                    width: 'calc(100% - 30px)',
                                    emptyValue: '',
                                    selected: ob.id,
                                    key: 'id',
                                    val: 'bank'
                                })   
                                                  
                             }
                        },
                        error:function(e){
                            console.log(e)
                            toastr.warning('Có lỗi xảy ra')
                        }
                    })
                    
                    return false
                })
                
                return false
            })
                
            
            $('[ng-click="addBankAccount()"]').unbind('click')
            $('[ng-click="addBankAccount()"]').click(function(){
                loadDef()
                
                $('.k-window-cashflowbank').show()
                $('.main>.k-overlay').css({
                    display:'block'                     
                })
                $('[k-ng-model="model.BankCode"]').select3({
                    sources: banks,
                    empty: '---Chọn ngân hàng---',
                    width: '100%',
                    emptyValue: ''
                })
                $('.k-window-cashflowbank .k-icon.k-i-close').unbind('click')
                $('.k-window-cashflowbank .k-icon.k-i-close').click(function(){
                    $('.k-window-cashflowbank').hide()
                    $('.main>.k-overlay').css({
                        display:'none'                     
                    })
                    return false;
                })
                
                $('[ng-keyup="autoResize($event)"]').unbind('keyup')
                $('[ng-keyup="autoResize($event)"]').keyup(function(){
                    
                })
                
                $('[ng-click="saveAccount()"]').unbind('click')
                $('[ng-click="saveAccount()"]').click(function(){
                    var x=_serialize('[kendo-window="bankWindow"]',[0,1,2,3,4])
                    if(x==''){
                        toastr.warning('Hãy điền hết các thông tin cơ bản')
                        return false
                    }
                    x = parse_str(decodeURIComponent(x))
                    /*
Account: "B"
AccountName: "D"
Bank: "A"
BankCode: "Vietcombank"
Branch: "C"
Description: "x x x ""                    
                    */
                    x = toLowserCaseObjectKeys(x)
                    $.ajax('ajax.php?action=bankaccount',{
                        data: x,
                        method: "POST",
                        dataType: 'json',
                        success: function(d){
                             //console.log(d)
                             if(d.error){
                                 toastr.warning('Có lỗi xảy ra')
                             }else{ 
                                 $('.k-window-cashflowbank .k-i-close').click()
                                  
                                 var ob = $.extend({},x,{id:d.id})
                                 bankaccounts.push(ob)
                                 saveBankAccount()
                                 
                                 $('[k-ng-model="filter.bankAcctId"]').select3('destroy')         
                                 $('[k-ng-model="filter.bankAcctId"]').select3({
                                    sources: bankaccounts,
                                    empty: '---Chọn---',
                                    width: 'calc(100% - 30px)',
                                    emptyValue: '',
                                    selected: d.id,
                                    key: 'id',
                                    val: 'bank'
                                })   
                                
                                $('[k-ng-model="filter.bankAcctId"]').trigger('change')                     
                             }
                        },
                        error:function(e){
                            console.log(e)
                            toastr.warning('Có lỗi xảy ra')
                        }
                    })
                    
                    return false
                })
                return false
            })
            
            $('[ng-model="CashFlowType"] .tabBg').width(55)
            $('[ng-model="CashFlowType"] ul li').click(function(){
                //alert($(this).index())
                var z= $(this).index()
                if(z!=CashFlowType){
                    CashFlowType = z;
                    $('[ng-model="CashFlowType"] .tabBg').animate({
                        width: $(this).width()+5,
                        left: $(this).position().left
                    })
                    $(this).parent().find('a').removeClass('active')
                    $(this).find('a').addClass('active')
                    
                    $('section.mainWrap article.headerContent span.ng-binding').html(_CashFlowType[CashFlowType])
                    
                    $('[ng-model="CashFlowType"] kv-tab-pane>div').addClass('ng-hide')
                    $('[ng-model="CashFlowType"] kv-tab-pane[kv-tab-id="'+(1-(0-z))+'"]>div').removeClass('ng-hide')
                    
                    loadTables()
                }
            })
            
            $('[k-ng-model="filter.bankAcctId"]').select3({
                sources: bankaccounts==null?[]:bankaccounts,
                empty: '---Chọn---',
                width: 'calc(100% - 30px)',
                emptyValue: '',
                key: 'id',
                val: 'bank'
            })
            
            $('[k-ng-model="filter.bankAcctId"]').change(function(){
                var v = $(this).val()
                if(v!=''){
                    $('[ng-show="filter.bankAcctId.Id !== -1"]').removeClass('ng-hide')
                }else{
                    $('[ng-show="filter.bankAcctId.Id !== -1"]').addClass('ng-hide')
                }
                filter.bankAccId = v
            })
            
            pretty('.mainLeft',function(d){
                if($(d).attr('ng-model')=='item.checked'){                     
                    filter.status = []
                    $('.mainLeft [ng-model="item.checked"]').each(function(i,v){
                        if($(this).is('[checked]'))
                            filter.status.push(parseInt($(this).attr('value')))    
                    })                     
                    cpage=0
                    loadTables(); 
                }else
                
                if($(d).attr('ng-model')=='item.type'){                     
                    filter.type = []
                    $('.mainLeft [ng-model="item.type"]').each(function(i,v){
                        if($(this).is('[checked]'))
                            filter.type.push(parseInt($(this).attr('value')))    
                    })                     
                    cpage=0
                    loadTables(); 
                }else
                if($(d).attr('ng-model')=='financialFilter'){                     
                    var oo = filter.financialFilter+0
                    var oo2 = parseInt($('.mainLeft [ng-model="financialFilter"][checked]').attr('value'))
                    if(oo==oo2) return false
                    filter.financialFilter = oo2
                    cpage=0
                    loadTables(); 
                }else if($(d).attr('ng-model')=='kvModel.typeDate'){
                    //alert(1)
                    var rf;
                    $('.mainLeft [ng-model="kvModel.typeDate"]').each(function(i,v){
                        if($(this).is('[checked]')){
                            rf = ($(this).attr('value'))
                        }                             
                    }) 
                    if(rf=='range'){
                        $('#reportsortDateTimeLbl').click()
                        var crange = findRangeByLabel($('#reportsortDateTimeLbl').html())
                    } else {
                        $('#reportsortOtherLbl').click()
                    }
                    
                    cpage=0
                    loadTables()
                }
                
            })
            
            $('.mainLeft [ng-model="filter.keywordParam"],.mainLeft [ng-model="filter.description"]').unbind('blur')
            $('.mainLeft [ng-model="filter.keywordParam"],.mainLeft [ng-model="filter.description"]').blur(function(e){
                oBlur(this)
            })
            $('.mainLeft [ng-model="filter.keywordParam"],.mainLeft [ng-model="filter.description"]').unbind('keyup')
            $('.mainLeft [ng-model="filter.keywordParam"],.mainLeft [ng-model="filter.description"]').keyup(function(e){
                if(e.which==13){
                    oBlur(this)    
                }
            })
            
            console.log('loadTableLeft');
            
            $('.mainLeft h3').unbind('click')
            $('.mainLeft h3').click(function(){
                i = $(this).find('i');
                
                //console.log($(this).next());
                
                
                if(i.hasClass('fa-chevron-circle-up')){
                    $(this).parent().find('aside').addClass('ng-hide');
                    i.removeClass('fa-chevron-circle-up');
                    i.addClass('fa-chevron-circle-down');
                }else{
                    $(this).parent().find('aside').removeClass('ng-hide');
                    i.addClass('fa-chevron-circle-up');
                    i.removeClass('fa-chevron-circle-down');
                }
            });
            
            //2019
            $('#reportsortDateTimeLbl').unbind('click')
            $('#reportsortDateTimeLbl').click(function(e){
                if(e.pageX!=undefined) return;
                /*$(this).next().css({
                    visibility: 'visible',
                    opacity: 1 
                })*/
                if($('aside.sortTimeList').css('visibility')=="hidden")
                    show1()
                else
                    hide1()
                    
                if($('aside.sortDateTimeOtherBox').css('visibility')!="hidden")                 
                    hide2()    
            })
            
            $('aside.sortTimeList li>a[ng-click]').unbind('click')
            $('aside.sortTimeList li>a[ng-click]').click(function(e){
                var x = $(this).attr('ng-click');
                //alert(x)
                eval(x);
                hide1();
            })
            
            $('[ng-click="filterByDateRange()"]').click(function(e){
                filterByDateRange()
            })
            
            $('#reportsortOtherLbl').click(function(e){
                if(e.pageX!=undefined) return;
                
                if(filter.range==''){
                    filter.range = moment().format('DD/MM/YYYY')
                    filter.range +='-'+filter.range
                    
                    _range = filter.range.split('-')
                }
                
                var xr = filter.range.split('-');
                $('span[ng-if="!kvBirthday"]:nth(0)').html(xr[0])
                $('span[ng-if="!kvBirthday"]:nth(1)').html(xr[1])
                $( "#fromDate" ).datepicker(
                    'option', 'defaultDate', xr[0]
                );
                $( "#toDate" ).datepicker(
                    'option', 'defaultDate', xr[1]
                );
                
                $( "#toDate" ).datepicker(
                    'option', 'minDate', $( "#fromDate" ).datepicker('getDate')
                );
                
                if($('aside.sortDateTimeOtherBox').css('visibility')=="hidden")
                    show2()
                else
                    hide2()
                    
                if($('aside.sortTimeList').css('visibility')!="hidden")                    
                    hide1()    
            })
            
            $( "#fromDate" ).datepicker({
                maxDate: new Date(),
                onSelect: function(val,$target){                       
                    $( "#toDate" ).datepicker(
                        'option', 'minDate', $(this).datepicker('getDate')
                    );
                    
                    $('span[ng-if="!kvBirthday"]:nth(0)').html(val)
                    
                    _range = filter.range.split('-')
                    _range[0] = val 
                     
                }
            });
            $( "#toDate" ).datepicker({
                maxDate: new Date(),
                onSelect: function(val,$target){                                            
                    $('span[ng-if="!kvBirthday"]:nth(1)').html(val)
                     
                    _range[1] = val 
                }
            });
             
            loadTables(); 
        }
        
        function show1(){
            $('aside.sortTimeList').css({
                visibility: 'visible',
                opacity: 1 
            })
        }
        
        function show2(){
            $('aside.sortDateTimeOtherBox').css({
                visibility: 'visible',
                opacity: 1 
            })
        }
        
        function hide1(){
            $('aside.sortTimeList').css({
                visibility: 'hidden',
                opacity: 0 
            })
        }
        
        function hide2(){
            $('aside.sortDateTimeOtherBox').css({
                visibility: 'hidden',
                opacity: 0 
            })
        }
        
        function filterbyRange(range){
            //alert(range)
            
            var yu = function(x){
                filter.range = x;
                cpage=0;
                loadTables();
            }
            
            if(range=='alltime'){
                yu('')
            }else{
             
                $.ajax({
                    url: '/ajax.php?action=rangeNameToRange&range='+range,
                    success: yu
                })
            
            }
            
            $('#reportsortDateTimeLbl').html(rngs[range])
        }
        
        function displayPartner(ob,x){
            $('.k-window-cashflow [ng-show="item.PartnerId"]').removeClass('ng-hide')
            $('.k-window-cashflow [ng-show="item.PartnerId"]>div>span>strong')[0].childNodes[1].nodeValue = " "+ob.name
            $('.k-window-cashflow [ng-show="item.PartnerId"]>div>span')[0].childNodes[5].nodeValue = "  " +ob.phone
            
            $('.k-window-cashflow [ng-click="updatePartner()"]').unbind('click')
            $('.k-window-cashflow [ng-click="updatePartner()"]').click(function(e){
                    
            })
            
            $('.k-window-cashflow [ng-click="removePartner()"]').unbind('click')
            $('.k-window-cashflow [ng-click="removePartner()"]').click(function(e){
                hidePartner()
            })
            
            if(item.partner && item.id==undefined)
                $('.k-window-cashflow [ng-show="item.PartnerId && !item.Id"]').removeClass('ng-hide')
            else
                $('.k-window-cashflow [ng-show="item.PartnerId && !item.Id"]').addClass('ng-hide')
            
            if(item.partnertype>0)
                $('.k-window-cashflow [ng-show="item.PartnerType == \'O\' && item.PartnerId"]').addClass('ng-hide')
            else{
                $('.k-window-cashflow [ng-show="item.PartnerType == \'O\' && item.PartnerId"]').removeClass('ng-hide')
                $('.k-window-cashflow [ng-show="item.PartnerType == \'O\' && item.PartnerId"]').attr('title','Sửa người '+(x?'nhận':'nộp'))
                $('.k-window-cashflow [ng-show="item.PartnerType == \'O\' && item.PartnerId"]').unbind('click')    
                $('.k-window-cashflow [ng-show="item.PartnerType == \'O\' && item.PartnerId"]').click(function(e){
                    if(item.partnertype>0) {
                        toastr.warning('Bạn không thể sửa')
                        return false
                    }
                    
                    var partner = $.extend({}, loadObject(item.partner,partners))
                    
                    console.log(partner)
                      
                    if(x){
                        //chi
                        $('.k-window-cashflowparner .k-window-title').html('Sửa người nhận')
                        $('.k-window-cashflowparner .ng-binding.control-label:nth(0)').html('Người nhận')
     
                    }else{
                        //thu
                        $('.k-window-cashflowparner .k-window-title').html('Sửa người nộp')
                        $('.k-window-cashflowparner .ng-binding.control-label:nth(0)').html('Người nộp')
     
                    }  
                    
                    //thu false chi true
                    $('.k-window-cashflowparner [ng-model],.k-window-cashflowparner [k-ng-model]').val('')
                    $('.k-window-cashflowparner').css({
                                'display': 'block', 
                                'z-index': 1002
                            })
                    $('.main>.k-overlay').css({
                        display:'block',
                        'z-index': 1001
                    })
                    $('.k-window-cashflowparner .k-i-close,.k-window-cashflowparner [ng-click="cancel()"]').unbind('click')
                    $('.k-window-cashflowparner .k-i-close,.k-window-cashflowparner [ng-click="cancel()"]').click(function(e){
                        $('.k-window-cashflowparner').hide()
                        $('.main>.k-overlay').css({
                            'z-index': 999    
                        })
                         
                        return false
                    })  
                     
                    $('.k-window-cashflowparner [ng-model="partner.Name"]').val(partner.name)
                    $('.k-window-cashflowparner [ng-model="partner.Name"]').unbind('blur')
                    $('.k-window-cashflowparner [ng-model="partner.Name"]').blur(function(e){
                        partner.name = $(this).val().trim()
                    })
                    
                    $('.k-window-cashflowparner [ng-model="partner.ContactNo"]').val(partner.phone)
                    $('.k-window-cashflowparner [ng-model="partner.ContactNo"]').unbind('blur')
                    $('.k-window-cashflowparner [ng-model="partner.ContactNo"]').blur(function(e){
                        partner.phone = $(this).val().trim()
                    })
                    
                    $('.k-window-cashflowparner [ng-model="partner.Address"]').val(partner.address)
                    $('.k-window-cashflowparner [ng-model="partner.Address"]').unbind('blur')
                    $('.k-window-cashflowparner [ng-model="partner.Address"]').blur(function(e){
                        partner.address = $(this).val().trim()
                    })
                    
                    $('.k-window-cashflowparner [ng-model="partner.Description"]').val(partner.note)
                    $('.k-window-cashflowparner [ng-model="partner.Description"]').unbind('blur')
                    $('.k-window-cashflowparner [ng-model="partner.Description"]').blur(function(e){
                        partner.note = $(this).val().trim()
                    })
                    
                    $('.k-window-cashflowparner [ng-click="savePartner()"]').unbind('click')
                    $('.k-window-cashflowparner [ng-click="savePartner()"]').click(function(e){
                        $('.k-window-cashflowparner [ng-model]').blur()
                        
                        if(partner.name==''){
                            toastr.warning('Bạn chưa nhập tên')
                            return false
                        }
                        
                        //console.log(partner,$.extend({branch:cb},partner));return false;
                        
                        $.ajax('ajax.php?action=partner',{
                            data: 'data='+JSON.stringify($.extend({branch:cb},partner)),
                            method: "POST",
                            dataType: 'json',
                            success: function(d){
                                 //console.log(d)
                                 if(d.error){
                                     toastr.warning('Có lỗi xảy ra')
                                 }else{
                                     $('.k-window-cashflowparner .k-i-close').click()
                                      
                                     var ob = loadObject(partner.id,partners)
                                     ob = $.extend(ob,partner)
                                     saveCachePartners()
                                     
                                     $('.k-detail-row:visible div.ng-binding:nth(2)').html(ob.name)
                                      
                                     //update 
                                     displayPartner(ob,x)
                                 }
                            },
                            error:function(e){
                                console.log(e)
                                toastr.warning('Có lỗi xảy ra')
                            }
                        })
                                            
                        return false
                    })
                })
            }
            
        }
        
        function hidePartner(){
            $('.k-window-cashflow [ng-show="item.PartnerId"]').addClass('ng-hide')
            item.partner = 0
        }
        
        function afterClick(ob,x){
                
            item.partner = ob.id
             
            displayPartner(ob,x)
                             
        }
        
        function paymentDetail(ob){
            var x = loaihds[ob.type][2]-1
            var payment = {
                date: ob.date+"",
                create: ob.create-0,
                note: ob.note+"",
                id: ob.id-0
            }
            
            //console.log(payment,ob)
                  
            if(x){
                //chi
                $('.k-window-paymentDetail .k-window-title').html('Phiếu chi')
                $('.k-window-paymentDetail label.ng-binding:nth(0)').html('Mã phiếu chi')
            }else{
                //thu
                $('.k-window-paymentDetail .k-window-title').html('Phiếu thu')
                $('.k-window-paymentDetail label.ng-binding:nth(0)').html('Mã phiếu thu') 
            }
            
            $('.k-window-paymentDetail label.ng-binding:nth(2)').html(typehds[loaihds[ob.type][3]])
            
            $('.k-window-paymentDetail [ng-model],.k-window-paymentDetail [k-ng-model]').val('')
            $('.k-window-paymentDetail').css({
                        'display': 'block', 
                        'z-index': 1002
                    })
            $('.main>.k-overlay').css({
                display:'block',
                'z-index': 1001
            })
            $('.k-window-paymentDetail .k-i-close').unbind('click')
            $('.k-window-paymentDetail .k-i-close').click(function(e){
                $('.k-window-paymentDetail').hide()
                $('.main>.k-overlay').hide()
                 
                return false
            })
            
            $('.k-window-paymentDetail strong.ng-binding').html(ob.code)
            
            //date
            $('.k-window-paymentDetail [kendo-date-time-picker]').val(xdate(ob.date))
            $('.k-window-paymentDetail [kendo-date-time-picker]').datetimepicker({
                format:'d/m/Y H:i'
            });
            $('.k-window-paymentDetail [kendo-date-time-picker]+span>span').unbind('click')
            $('.k-window-paymentDetail [kendo-date-time-picker]+span>span').click(function(){
                $(this).parent().prev().datetimepicker('show'); //support hide,show and destroy command
            });
            
            //users
             
            sl = $('.k-window-paymentDetail .k-dropdown:nth(0) select');
            sl.html('');
             
            for(var i in users){
                op2 = op;
                op2 = op2.replace(/\{\{id\}\}/,users[i].id);
                op2 = op2.replace(/\{\{name\}\}/,users[i].name);
                sl.append(op2);
            }
            $('.k-window-paymentDetail .k-dropdown:nth(0) .k-dropdown-wrap').unbind('click')
            $('.k-window-paymentDetail .k-dropdown:nth(0) .k-dropdown-wrap').click(function(){
                $(this).next().show();
            });
            
            sl = $('.k-window-paymentDetail .k-dropdown:nth(0) .k-animation-container ul');
             
            sl.html('');
             
            for(var j in users){
                opp2 = opp;
                opp2 = opp2.replace(/\{\{i\}\}/,parseInt(j)+1);
                opp2 = opp2.replace(/\{\{name\}\}/,users[j].name);
                sl.append(opp2);
            }
              
            //br22 = users[0];
            
            ////$('.k-window-paymentDetail .k-dropdown:nth(0) .k-dropdown-wrap .k-input').html(br22.name);
            ////$('.k-window-paymentDetail .k-dropdown:nth(0) select option[value="'+br22.id+'"]').attr('selected','selected');
            
            
            //set hover
            $('.k-window-paymentDetail .k-dropdown:nth(0) .k-animation-container').hover(
                function(){
                    //$('.k-window-paymentDetail .k-dropdown:nth(0) .k-animation-container').show();
                },
                function(){
                    $('.k-window-paymentDetail .k-dropdown:nth(0) .k-animation-container').hide();
                }
            );
            
            $('.k-window-paymentDetail .k-dropdown:nth(0) .k-animation-container ul li').hover(
                function(){
                    $(this).toggleClass('k-state-hover');
                },function(){
                    $(this).toggleClass('k-state-hover');
                }
            );
            $('.k-window-paymentDetail .k-dropdown:nth(0) .k-animation-container ul li').unbind('click')
            //set click
            $('.k-window-paymentDetail .k-dropdown:nth(0) .k-animation-container ul li').click(
                function(){
                    
                    //console.log($(this).data('offset-index'));
                    
                    offset = parseInt($(this).data('offset-index')); //+1
                    
                    $('.k-window-paymentDetail .k-dropdown:nth(0) select option').removeAttr('selected');                    
                    $('.k-window-paymentDetail .k-dropdown:nth(0) select option:nth-child('+offset+')').attr('selected','selected');
                    
                    $('.k-window-paymentDetail .k-dropdown:nth(0) .k-dropdown-wrap .k-input').html($(this).html());
                     
                    $('.k-window-paymentDetail .k-dropdown:nth(0) .k-animation-container').hide();
                    
                     
                    payment.create = $('.k-window-paymentDetail .k-dropdown:nth(0) select option:nth-child('+offset+')').attr('value')
                     
                }
            );
            var tj
             
            tj = $('.k-window-paymentDetail .k-dropdown:nth(0) select option[value="'+payment.create+'"]')    
            
            console.log(tj)            
             
            tj.attr('selected','selected');
            $('.k-window-paymentDetail .k-dropdown:nth(0) .k-dropdown-wrap .k-input').html(tj.html()); 
            //end user (create)
            
            //note
            $('.k-window-paymentDetail [ng-model="description"]').val(payment.note)
            $('.k-window-paymentDetail [ng-model="description"]').unbind('blur')
            $('.k-window-paymentDetail [ng-model="description"]').blur(function(e){
                payment.note = $(this).val().trim()
            })
            
            //supplier, customer: loaihds[ob.type][1]
            var xa = ob[loaihds[ob.type][1]]
            if(xa){
                xa = eval("load"+loaihds[ob.type][1].capitalizeOne()+"(ob."+loaihds[ob.type][1]+")")
                
                $('.k-window-paymentDetail [ng-show="customerName==\'\'"]').addClass('ng-hide')
                $('.k-window-paymentDetail [ng-show="customerName!=\'\'"]').removeClass('ng-hide')
                
                $('.k-window-paymentDetail [ng-show="customerName!=\'\'"]').attr('href',"#/"+loaihds[ob.type][1].capitalizeOne()+"s?Code="+xa.code)
                $('.k-window-paymentDetail [ng-show="customerName!=\'\'"]').html(xa.name)
            }else{
                $('.k-window-paymentDetail [ng-show="customerName==\'\'"]').removeClass('ng-hide')
                $('.k-window-paymentDetail [ng-show="customerName!=\'\'"]').addClass('ng-hide')
            }
            $('#grdDetailPayment tbody tr:first-child td:nth(0)').html(ob.code.replace(/^(TT|PT)/,""))
            if((ob.type==2 ||ob.type==4 ||ob.type==6 ) && ob.note && ob.note.match(/ ([^ ]+)$/)){
                $('#grdDetailPayment tbody tr:first-child td:nth(0)').html(ob.note.match(/ ([^ ]+)$/)[1])    
            }
                
            $('#grdDetailPayment tbody tr:first-child td:nth(1)').html(xdate(ob.date))
            $('#grdDetailPayment tbody tr:first-child td:nth(2)').html(formatCurrency(ob.price))
             
            $('#grdDetailPayment tbody tr:first-child td:nth(4)').html(formatCurrency(ob.paying))
            $('#grdDetailPayment tbody tr:first-child td:nth(5) span').html(ob.status==1?'Đã thanh toán':'Đã hủy')
            $('.k-window-paymentDetail td.ng-binding:last-child').html(formatCurrency(ob.paying))
            
            //cap nhat
            $('.k-window-paymentDetail [ng-click="update()"]').unbind('click')
            $('.k-window-paymentDetail [ng-click="update()"]').click(function(e){
                $('.k-window-paymentDetail [ng-model="description"]').blur()
                console.log(payment)
                
                $.ajax('ajax.php?action=doeditcashflow',{
                    data: JSON.stringify(payment),
                    method: "POST",
                    dataType: 'json',
                    success: function(d){
                        console.log(d);
                        if(d.status=='1'){
                            $('.k-window-paymentDetail .k-i-close').click()
                            
                            var b = loadObject(payment.id,invoices)
                            b.note = payment.note
                            b.create = payment.create
                            b.date = payment.date
                            saveCacheInvoices_cashflows(invoices)
                            toastr.success("Sửa phiếu "+(x?'chi':'thu')+" thành công")
                             
                        }else{
                            toastr.warning("Sửa phiếu "+(x?'chi':'thu')+" lỗi") 
                        } 
                    }
                });   
            })
            //in
            $('.k-window-paymentDetail [ng-click="print()"]').unbind('click')
            $('.k-window-paymentDetail [ng-click="print()"]').click(function(e){
                inhoadon(ob)
            })
            //huy bo
            /*$('.k-window-paymentDetail [ng-click="cancel()"]').unbind('click')
            $('.k-window-paymentDetail [ng-click="cancel()"]').click(function(e){
                //Huy phieu TTPN thanh toan nhap hang thi se thay doi debt cua supplier va cho paying cua invoice PN tuong ung = 0
            })*/
            
            if(ob.id!=undefined && ob.status!=2){
                $('.k-window-paymentDetail [ng-hide="disabled || !rights.canDelete"]').removeClass('ng-hide')
                $('.k-window-paymentDetail [ng-click="cancel()"]').unbind('click')
                $('.k-window-paymentDetail [ng-click="cancel()"]').click(function(e){
                    //chi co 2 truong hop type=2,4,6 phieu thu phieu chi thoi
                    
                    //hien bang popup
                    $('.main>.k-overlay').css({
                        'z-index':1003
                    })
                    $('.main>.k-window-alert').show()
                    $('.main>.k-window-alert').css({
                        top: ($(window).height()-$('.main>.k-window-alert').height())/2+window.scrollY,
                        left: ($(window).width()-$('.main>.k-window-alert').width())/2,
                        'z-index':1004
                    })
                    $('.main>.k-window-alert .k-window-title').html('Hủy bỏ phiếu thu/chi')
                    $('.main>.k-window-alert .confirm-message').html('Bạn chắc chắn muốn hủy bỏ phiếu thu/chi này?')
                    
                    $('.main>.k-window-alert .k-i-close,.main>.k-window-alert [ng-enter="onCancel()"]').unbind('click')
                    $('.main>.k-window-alert .k-i-close,.main>.k-window-alert [ng-enter="onCancel()"]').click(function(e){
                        $('.main>.k-window-alert').hide()
                        $('.main>.k-overlay').css({
                            'z-index': 1001    
                        })
                         
                        return false
                    })
                    $('.main>.k-window-alert [ng-enter="onConfirm()"]').unbind('click')
                    $('.main>.k-window-alert [ng-enter="onConfirm()"]').click(function(e){                    
                        //ajax
                        $.ajax('ajax.php?action=delete_cashflow',{
                            data: 'id='+ob.id,
                            method: "POST",
                            dataType: 'json',
                            success: function(d){
                                 //console.log(d)
                                 if(d.error){
                                     toastr.warning('Có lỗi xảy ra')
                                 }else{
                                    
                                     $('.main>.k-window-alert .k-i-close').click()
                                    
                                     //$('.main>.k-window-cashflow .k-i-close').click()
                                     $('.k-window-paymentDetail .k-i-close').click()
                                      
                                     //var ob = loadObject(ob.id,invoices)
                                     ob.status=2;
                                     console.log('ha hoi ha hoi 2',ob)
                                     saveCacheInvoices_cashflows(invoices)
                                      
                                     loadTables()
                                     
                                     toastr.success('Xóa thành công') 
                                     
                                     //08/05/2019 change debt
                                     if(ob.partnertype==1 || ob.partnertype==2){
                                        var $multiple = ob.type==8?1:-1;
                                        var $table = ob.partnertype==1?'customer':'supplier';
                                        
                                        if(ob.partnertype==1){
                                            var ox = loadCustomer(ob.partner)
                                            ox.debt = parseInt(ox.debt)+$multiple*ob.price
                                            saveCacheCustomers()
                                        }else{
                                            var ox = loadSupplier(ob.partner)
                                            ox.debt = parseInt(ox.debt)+$multiple*ob.price
                                            saveCacheSuppliers()
                                        }  
                                     } 
                                 }
                            },
                            error:function(e){
                                console.log(e)
                                toastr.warning('Có lỗi xảy ra')
                            }
                        })
                        //alert(ob.id)
                        console.log('ha hoi ha hoi')
                        return false
                    })
                    return false
                })
            }
                
            else
                $('.k-window-paymentDetail [ng-hide="disabled || !rights.canDelete"]').addClass('ng-hide')
            
            
            if(vkl['6.1.3']==undefined)
                $('.k-window-paymentDetail [ng-click="update()"]').addClass('ng-hide')
            else
                $('.k-window-paymentDetail [ng-click="update()"]').removeClass('ng-hide')
            if(vkl['6.1.4']==undefined || ob.status==2)
                $('.k-window-paymentDetail [ng-click="cancel()"]').addClass('ng-hide')
            else
                $('.k-window-paymentDetail [ng-click="cancel()"]').removeClass('ng-hide')
        }
         
        function createItem(x,vb){
            if(x==undefined) x= false;
            
            //8 thu 9 chi
            if(vb==undefined)
                item = {
                    type: (x?1:0) + 8,
                    price: '',
                    partner: 0
                }
            else
                item = vb
            
            //console.log(item)    
            //alert(item.code)    
            
            var checkCanUseUsed = function(item){
                if(item.cashflowtype==0){
                    return -1
                }
                var cashflowtype = loadObject(item.partnertype,bill_types)
                
                return cashflowtype.used
            }
            
            if(x){
                //chi
                $('.k-window-cashflow .k-window-title').html((item.id?'Sửa':'Lập')+' phiếu chi')
                $('.k-window-cashflow .ng-binding.control-label:nth(2)').html('Loại chi')
                $('.k-window-cashflow .ng-binding.control-label:nth(3)').html('Nhóm người nhận')
                $('.k-window-cashflow .ng-binding.control-label:nth(4)').html('Tên người nhận')
                $('.k-window-cashflow .ng-binding.control-label:nth(5)').html('Tên người nhận')
            }else{
                //thu
                $('.k-window-cashflow .k-window-title').html((item.id?'Sửa':'Lập')+' phiếu thu')
                $('.k-window-cashflow .ng-binding.control-label:nth(2)').html('Loại thu')
                $('.k-window-cashflow .ng-binding.control-label:nth(3)').html('Nhóm người nộp')
                $('.k-window-cashflow .ng-binding.control-label:nth(4)').html('Tên người nộp')
                $('.k-window-cashflow .ng-binding.control-label:nth(4)').html('Tên người nộp')
            }
             
            
            //thu false chi true
            $('.k-window-cashflow [ng-model],.k-window-cashflow [k-ng-model]').val('')
            $('.k-window-cashflow').css({
                        'display': 'block', 
                        'z-index': 1000
                    })
            $('.main>.k-overlay').css({
                display:'block',
                'z-index': 999
            })
            $('.k-window-cashflow .k-i-close,.k-window-cashflow [ng-click="onCancel()"]').unbind('click')
            $('.k-window-cashflow .k-i-close,.k-window-cashflow [ng-click="onCancel()"]').click(function(e){
                $('.k-window-cashflow').hide()
                $('.main>.k-overlay').hide()
                 
                return false
            })
            /*
            $('.k-window-cashflow span.mainSelect').css({
                width: 'calc(100% - 32px)'
            })*/
            
            //date
            $('.k-window-cashflow [kendo-date-time-picker]').datetimepicker({
                format:'d/m/Y H:i'
            });
            $('.k-window-cashflow [kendo-date-time-picker]+span>span').unbind('click')
            $('.k-window-cashflow [kendo-date-time-picker]+span>span').click(function(){
                $(this).parent().prev().datetimepicker('show'); //support hide,show and destroy command
            });
            
            if(item.date==undefined) item.date = nCode2()
            else if(item.date.match(/\d+\-\d+\-\d+ \d+\:\d+\:\d+/)) item.date = xdate(item.date)
            
            $('.k-window-cashflow [kendo-date-time-picker]').val(item.date)
            
            $('.k-window-cashflow [kendo-date-time-picker]').unbind('change')
            $('.k-window-cashflow [kendo-date-time-picker]').change(function(e){
                item.date = $(this).val()
            })
            
            //loai thu/chi:
            
            $('.k-window-cashflow [ng-click="addCashflowGroup()"]').attr('title','Thêm loại '+(x?'chi':'thu'))
            $('.k-window-cashflow [ng-click="updateCashGroup()"]').attr('title','Sửa loại '+(x?'chi':'thu'))
            $('.k-window-cashflow [ng-click="addPartner()"]').attr('title','Thêm người '+(x?'nhận':'nộp'))
            
            var setUsed = function(used,n,m){
                if(used==-1) return false;
                n = n==undefined?'cashflow':n
                m = m==undefined?'item':m         
                console.log(n,m,m+".used="+used)       
                eval(m+".used="+used)
                if(used==1){
                    console.log($('.k-window-'+n+' .prettycheckbox>input + a + label,.k-window-'+n+' .prettycheckbox>input + a')) 
                    $('.k-window-'+n+' .prettycheckbox>input + a + label,.k-window-'+n+' .prettycheckbox>input + a').addClass('checked')
                    $('.k-window-'+n+' [ng-model="'+m+'.UsedForFinancialReporting"]').attr('checked','checked')
                }else{
                    console.log($('.k-window-'+n+' .prettycheckbox>input + a + label,.k-window-'+n+' .prettycheckbox>input + a')) 
                    $('.k-window-'+n+' .prettycheckbox>input + a + label,.k-window-'+n+' .prettycheckbox>input + a').removeClass('checked')
                    $('.k-window-'+n+' [ng-model="'+m+'.UsedForFinancialReporting"]').removeAttr('checked')
                }
            } 
             
            var mv = function (jj){ //alert(jj+'-jj')
                $('#ddlCashflowGroup option').removeAttr('selected')
                $('#ddlCashflowGroup option[value="'+jj+'"]').attr('selected','selected')
                $('.k-window-cashflow .k-dropdown:nth(0) .k-input').html($('#ddlCashflowGroup option[value="'+jj+'"]').html())
                item.cashflowtype = jj
                if(jj>0){                    
                    /*$('#ddlCashflowGroup option').removeAttr('selected')
                    $('#ddlCashflowGroup option[value="'+bill_types[ii-1].id+'"]').attr('selected','selected')
                    $('.k-window-cashflow .k-dropdown:nth(0) .k-input').html(bill_types[ii-1].name)
                    item.cashflowtype = bill_types[ii-1].id*/
                    
                    $('.k-window-cashflow [ng-click="addCashflowGroup()"]').addClass('ng-hide')
                    $('.k-window-cashflow [ng-click="updateCashGroup()"]').removeClass('ng-hide')
                    //alert('vkvkvkvkvkvkvkv2222222222444444444444444') 
                    console.log(setUsed)
                    if(item.id)  
                        setUsed(item.used)
                    else                  
                        setUsed(loadObject(jj,bill_types).used)
                    //alert('vkvkvkvkvkvkvkv22222222223333333333333333') 
                }else{
                    /*$('#ddlCashflowGroup option').removeAttr('selected')
                    $('#ddlCashflowGroup option[value="0"]').attr('selected','selected')
                    $('.k-window-cashflow .k-dropdown:nth(0) .k-input').html($('#ddlCashflowGroup option[value="0"]').html())
                    item.cashflowtype = 0*/
                    
                    $('.k-window-cashflow [ng-click="addCashflowGroup()"]').removeClass('ng-hide')
                    $('.k-window-cashflow [ng-click="updateCashGroup()"]').addClass('ng-hide')
                }    
            }
            
            var ll0_ = '<li tabindex="-1" role="option" unselectable="on" class="k-item ng-scope k-state-selected k-state-focused" data-offset-index="0" id="54cedff2-c07f-4d5a-a0ad-d3bc988bfc4a">--Chọn thu nhập khác--</li>'
            var g1 = function(e){
                var ii = parseInt($(this).attr('data-offset-index'))
                console.log('ffff',ii)
                mv(ii>0?bill_types[ii-1].id:0) ; console.log('gggggggggggggggggggggg')
                 
                $('.main>.k-animation-container').hide() 
            }
            var gg3 = function(i){
                var ll = $('<li tabindex="-1" role="option" unselectable="on" class="k-item ng-scope" data-offset-index="'+(parseInt(i)+1)+'">'+bill_types[i].name+'</li>')
                ll.hover(function(e){
                    $(this).addClass('k-state-hover')
                },function(e){
                    $(this).removeClass('k-state-hover')
                })
                ll.click(g1)
                $('.main>.k-animation-container ul').append(ll)
            }
            
            var cf = function(cft){
                //alert(cft)
                cft = cft==undefined?0:cft
            
                $('#ddlCashflowGroup').html('<option value="0" selected="selected">--Chọn thu nhập khác--</option>')
                
                item.cashflowtype = cft  
             
                for(var i in bill_types){
                    if(x){
                        //chi
                        if(bill_types[i].type==1) continue;
                    }else{
                        //thu
                        if(bill_types[i].type==2) continue;
                    }
                    $('#ddlCashflowGroup').append('<option value="'+bill_types[i].id+'">'+bill_types[i].name+'</option>')
                    ////gg3(i)
                }
                 
                $('.k-window-cashflow .k-dropdown:nth(0) .k-input').html($('#ddlCashflowGroup option[value="'+cft+'"]').html())
              
                $('.k-window-cashflow .k-dropdown:nth(0)').unbind('click')
                $('.k-window-cashflow .k-dropdown:nth(0)').click(function(e){
                    var ll0=$(ll0_)//ll0.unbind('click')
                    ll0.click(g1); console.log('ll0.click(g1)')
                    $('.main>.k-animation-container ul').html(ll0)
                    for(var i in bill_types){   
                        if(x){
                            //chi
                            if(bill_types[i].type==1) continue;
                        }else{
                            //thu
                            if(bill_types[i].type==2) continue;
                        }
                        gg3(i)
                    }
                    var that = $(this)
                    $('.main>.k-animation-container').css({
                        display: 'block',
                        top: that.offset().top+that.height(),
                        left: that.offset().left,
                        width: that.width()
                    })
                    
                    $('.main>.k-animation-container>div').css({
                        display: 'block',
                        transform: 'translateY(0px)',
                        width: that.width()
                    })
                })
                $('.main>.k-animation-container ul').unbind('hover')
                $('.main>.k-animation-container ul').hover(function(e){
                        
                },function(e){
                    $('.main>.k-animation-container').hide() 
                }); //alert('end '+cft)
            }
            
            if(item.cashflowtype==undefined)
                cf()
            else{ //alert('vkvkvkvkvkvkvkv2222222222333333333')
                cf(item.cashflowtype)
                //alert('vkvkvkvkvkvkvkv2222222222') 
                mv(item.cashflowtype)
            } 
            //end loai thu
            //alert('vkvkvkvkvkvkvkv2222222222')
            //nhom nguoi nhan:
            var vkl = function(ii){
                console.log('vkl',ii)
                if(ii)
                    $('.k-window-cashflow [ng-show="item.PartnerType == \'O\'"]').addClass('ng-hide')
                else
                    $('.k-window-cashflow [ng-show="item.PartnerType == \'O\'"]').removeClass('ng-hide')
            }
            if(item.partnertype==undefined)
                item.partnertype = 0
                
            //alert('vkvkvkvkvkvkvkv')    
                
            var g12 = function(e){
                var ii = parseInt($(this).attr('data-offset-index'))
                //ii = bill_types[ii-1].id                   
                $('#ddlCashflowType option').removeAttr('selected')
                $('#ddlCashflowType option[value="'+ii+'"]').attr('selected','selected')
                $('.k-window-cashflow .k-dropdown:nth(1) .k-input').html(typehds[ii])
                
                $('.main>.k-animation-container').hide() 
                if(item.partnertype != ii){
                    item.partnertype = ii
                     
                    vkl(ii)
                    hidePartner()
                }
            } 
            
            var gg32 = function(i){
                var ll = $('<li tabindex="-1" role="option" unselectable="on" class="k-item ng-scope" data-offset-index="'+i+'">'+typehds[i]+'</li>')
                ll.hover(function(e){
                    $(this).addClass('k-state-hover')
                },function(e){
                    $(this).removeClass('k-state-hover')
                })
                ll.click(g12)
                $('.main>.k-animation-container ul').append(ll)
            }
            $('#ddlCashflowType').html('')
            for(var i in typehds){
                $('#ddlCashflowType').append('<option value="'+i+'">'+typehds[i]+'</option>')                 
            }
            
            $('#ddlCashflowType option[value="'+item.partnertype+'"]').attr('selected','selected') 
            $('.k-window-cashflow .k-dropdown:nth(1) .k-input').html($('#ddlCashflowType option[value="'+item.partnertype+'"]').html())
            
            $('.k-window-cashflow .k-dropdown:nth(1)').unbind('click')
            if(item.id==undefined){                
                $('.k-window-cashflow .k-dropdown:nth(1)').click(function(e){
                    $('.main>.k-animation-container ul').html('')
                    for(var i in typehds){                    
                        gg32(i)
                    }
                    var that = $(this)
                    $('.main>.k-animation-container').css({
                        display: 'block',
                        top: that.offset().top+that.height(),
                        left: that.offset().left,
                        width: that.width()
                    })
                    
                    $('.main>.k-animation-container>div').css({
                        display: 'block',
                        transform: 'translateY(0px)',
                        width: that.width()
                    })
                })
                $('.k-window-cashflow .k-dropdown:nth(1)>span').removeClass('k-state-disabled')
                $('.k-window-cashflow [ng-hide="item.Id"]').removeClass('ng-hide')
                $('.k-window-cashflow [ng-show="item.Id"]').addClass('ng-hide')
            }else{
                $('.k-window-cashflow .k-dropdown:nth(1)>span').addClass('k-state-disabled')
                $('.k-window-cashflow [ng-hide="item.Id"]').addClass('ng-hide')
                $('.k-window-cashflow [ng-show="item.Id"]').removeClass('ng-hide')
            }
            //end nhom nguoi nhan
            
            var group = {}
            //prettycheckbox
            /*var setUsed = function(used,n,m){
                if(used==-1) return false;
                n = n==undefined?'cashflow':n
                m = m==undefined?'item':m         
                console.log(n,m,m+".used="+used)       
                eval(m+".used="+used)
                if(used==1){
                    console.log($('.k-window-'+n+' .prettycheckbox>input + a + label,.k-window-'+n+' .prettycheckbox>input + a')) 
                    $('.k-window-'+n+' .prettycheckbox>input + a + label,.k-window-'+n+' .prettycheckbox>input + a').addClass('checked')
                    $('.k-window-'+n+' [ng-model="'+m+'.UsedForFinancialReporting"]').attr('checked','checked')
                }else{
                    console.log($('.k-window-'+n+' .prettycheckbox>input + a + label,.k-window-'+n+' .prettycheckbox>input + a')) 
                    $('.k-window-'+n+' .prettycheckbox>input + a + label,.k-window-'+n+' .prettycheckbox>input + a').removeClass('checked')
                    $('.k-window-'+n+' [ng-model="'+m+'.UsedForFinancialReporting"]').removeAttr('checked')
                }
            } */
            
            if(!item.id)
                setUsed(1);  
            else 
                setUsed(item.used)
                   
            
            $('.k-window-cashflow .prettycheckbox>input + a + label,.k-window-cashflow .prettycheckbox>input + a').unbind('click')
            $('.k-window-cashflow .prettycheckbox>input + a + label,.k-window-cashflow .prettycheckbox>input + a').click(function(e){
                console.log('checkCanUseUsed:',checkCanUseUsed(item))
                var c = checkCanUseUsed(item)
                if(c==-1){
                    $('.k-window-cashflow .prettycheckbox>input + a + label,.k-window-cashflow .prettycheckbox>input + a').toggleClass('checked')
                    console.log($(this).siblings('input'))
                    if($(this).hasClass('checked')){
                        $(this).siblings('input').attr('checked','checked')
                        item.used = 1
                    }else{
                        $(this).siblings('input').removeAttr('checked')
                        item.used = 0
                    }
                }else{
                    
                }
            })
            
            if(item.code==undefined){
                item.code = ''
                $('.k-window-cashflow [ng-model="item.Code"]').unbind('change')
                $('.k-window-cashflow [ng-model="item.Code"]').change(function(e){
                    
                    //check cac code cu xem co trung k
                    if($(this).val()=='') return false;
                    var that = this
                    $.ajax('ajax.php?action=checkcode',{
                        data: 'code='+$(this).val(),
                        method: "POST",
                        dataType: 'json',
                        success: function(d){
                             //console.log(d)
                             if(d.error){
                                 toastr.warning('Trùng mã phiếu')
                                 $(that).val('')
                                 item.code =''
                             }else{
                                 item.code = $(this).val() 
                             }
                        },
                        error:function(e){
                            console.log(e)
                            toastr.warning('Có lỗi xảy ra')
                            
                            $(that).val('')
                            item.code ='' 
                        }
                    })
                })
                $('.k-window-cashflow [ng-model="item.Code"]').removeAttr('readonly')
            }else{
                $('.k-window-cashflow [ng-model="item.Code"]').val(item.code)
                $('.k-window-cashflow [ng-model="item.Code"]').attr('readonly','readonly')
            }
            //check number             
            $('.k-window-cashflow [ng-model="item.Value"]').unbind('blur')
            $('.k-window-cashflow [ng-model="item.Value"]').blur(function(e){
                var vv = $(this).val()
                
                if(vv!=''){
                    if(vv.match(/^\d+$/)){
                        item.price = vv
                    }else{
                        toastr.warning('Sai định dạng số')
                        
                        $(this).val('')
                    }
                }
            })
            if(item.price) $('.k-window-cashflow [ng-model="item.Value"]').val(item.price)
            
            if(item.note==undefined)
                item.note = ''
            $('.k-window-cashflow [ng-model="item.Description"]').unbind('change')
            $('.k-window-cashflow [ng-model="item.Description"]').change(function(e){
                item.note = $(this).val()
            })
            if(item.note) $('.k-window-cashflow [ng-model="item.Description"]').val(item.note)
            
            $('.k-window-cashflow [ng-click="savePayment()"]').unbind('click')
            $('.k-window-cashflow [ng-click="savePayment()"]').click(function(e){
                $('.k-window-cashflow [ng-model]').blur()
                //console.log(item);return;
                if(item.price == ''){
                    toastr.warning('Bạn chưa nhập giá trị')
                    return false
                }
                 
                if(item.partner==0){
                    toastr.warning('Bạn chưa chọn tên người '+(x?'nhận':'nộp'))
                    return false
                }
                
                $.ajax('ajax.php?action=cashflow',{
                    data: 'data='+JSON.stringify($.extend({branch:cb,status:1},item)),
                    method: "POST",
                    dataType: 'json',
                    success: function(d){
                         //console.log(d)
                         if(d.error){
                             toastr.warning('Có lỗi xảy ra')
                         }else{
                             $('.k-window-cashflow .k-i-close').click()
                             
                             if(item.id==undefined) {//add
                                 var ob = $.extend({},item,{code:d.code,branch:cb,id:d.id,create:create,status:1})
                                 
                                 //invoices.push(ob)
                                 invoices.unshift(ob) //changed 08/05/2019
                                 
                                 saveCacheInvoices_cashflows(invoices)
                                  
                             }else{ //edit
                                 var ob = loadObject(item.id,invoices)
                                 
                                 ob = $.extend(ob,item)
                                 saveCacheBillTypes()
                             }
                             
                             //2019 change debt
                             if(item.partnertype==1 || item.partnertype==2){
                                var $multiple = item.type==8?-1:1;
                                var $table = item.partnertype==1?'customer':'supplier';
                                
                                if(item.partnertype==1){
                                    var ox = loadCustomer(item.partner)
                                    ox.debt = parseInt(ox.debt)+$multiple*item.price
                                    saveCacheCustomers()
                                }else{
                                    var ox = loadSupplier(item.partner)
                                    ox.debt = parseInt(ox.debt)+$multiple*item.price
                                    saveCacheSuppliers()
                                }
                             }
                             
                             loadTableLeft()
                         }
                    },
                    error:function(e){
                        console.log(e)
                        toastr.warning('Có lỗi xảy ra')
                    }
                })                
                
                
                return false
            })
            
            
            
            //them nguoi nhan/nop
            
            $('.k-window-cashflow [ng-click="addPartner()"]').unbind('click')
            $('.k-window-cashflow [ng-click="addPartner()"]').click(function(e){
                if(item.partnertype>0) {
                    toastr.warning('Bạn không thể thêm')
                    return false
                }
                
                var partner = {name:'',note:'',address:'',phone:''}
                  
                if(x){
                    //chi
                    $('.k-window-cashflowparner .k-window-title').html('Thêm người nhận')
                    $('.k-window-cashflowparner .ng-binding.control-label:nth(0)').html('Người nhận')
 
                }else{
                    //thu
                    $('.k-window-cashflowparner .k-window-title').html('Thêm người nộp')
                    $('.k-window-cashflowparner .ng-binding.control-label:nth(0)').html('Người nộp')
 
                }
                
                //thu false chi true
                $('.k-window-cashflowparner [ng-model],.k-window-cashflowparner [k-ng-model]').val('')
                $('.k-window-cashflowparner').css({
                            'display': 'block', 
                            'z-index': 1002
                        })
                $('.main>.k-overlay').css({
                    display:'block',
                    'z-index': 1001
                })
                $('.k-window-cashflowparner .k-i-close,.k-window-cashflowparner [ng-click="cancel()"]').unbind('click')
                $('.k-window-cashflowparner .k-i-close,.k-window-cashflowparner [ng-click="cancel()"]').click(function(e){
                    $('.k-window-cashflowparner').hide()
                    $('.main>.k-overlay').css({
                        'z-index': 999    
                    })
                     
                    return false
                })
                
                $('.k-window-cashflowparner [ng-model="partner.Name"]').unbind('blur')
                $('.k-window-cashflowparner [ng-model="partner.Name"]').blur(function(e){
                    partner.name = $(this).val().trim()
                })
                
                $('.k-window-cashflowparner [ng-model="partner.ContactNo"]').unbind('blur')
                $('.k-window-cashflowparner [ng-model="partner.ContactNo"]').blur(function(e){
                    partner.phone = $(this).val().trim()
                })
                
                $('.k-window-cashflowparner [ng-model="partner.Address"]').unbind('blur')
                $('.k-window-cashflowparner [ng-model="partner.Address"]').blur(function(e){
                    partner.address = $(this).val().trim()
                })
                
                $('.k-window-cashflowparner [ng-model="partner.Description"]').unbind('blur')
                $('.k-window-cashflowparner [ng-model="partner.Description"]').blur(function(e){
                    partner.note = $(this).val().trim()
                })
                
                $('.k-window-cashflowparner [ng-click="savePartner()"]').unbind('click')
                $('.k-window-cashflowparner [ng-click="savePartner()"]').click(function(e){
                    $('.k-window-cashflowparner [ng-model]').blur()
                    
                    if(partner.name==''){
                        toastr.warning('Bạn chưa nhập tên')
                        return false
                    }
                    
                    console.log(partner)
                    
                    $.ajax('ajax.php?action=partner',{
                        data: 'data='+JSON.stringify($.extend({branch:cb},partner)),
                        method: "POST",
                        dataType: 'json',
                        success: function(d){
                             //console.log(d)
                             if(d.error){
                                 toastr.warning('Có lỗi xảy ra')
                             }else{
                                 $('.k-window-cashflowparner .k-i-close').click()
                                  
                                 var ob = $.extend({},partner,{id:d.id})
                                 partners.push(ob)
                                 saveCachePartners()
                                 
                                 item.partner = ob.id
                                 
                                 //update 
                                 displayPartner(ob,x)
                             }
                        },
                        error:function(e){
                            console.log(e)
                            toastr.warning('Có lỗi xảy ra')
                        }
                    })
                                        
                    return false
                })
            })
            
            //them loai thu chi
            $('.k-window-cashflow [ng-click="addCashflowGroup()"],.k-window-cashflow [ng-click="updateCashGroup()"]').unbind('click')
            $('.k-window-cashflow [ng-click="addCashflowGroup()"],.k-window-cashflow [ng-click="updateCashGroup()"]').click(function(e){
                var doo = item.cashflowtype > 0?'edit':'add'
                if(doo=='add')
                    group = {name:'',note:''}
                else
                    group = $.extend({}, loadObject(item.cashflowtype,bill_types) ) 
                 
                if(x){
                    //chi
                    $('.k-window-cashgroup .k-window-title').html((doo=='add'?'Thêm':'Sửa')+' loại chi')
                    $('.k-window-cashgroup .ng-binding.control-label:nth(0)').html('Loại chi')
                     
                }else{
                    //thu
                    $('.k-window-cashgroup .k-window-title').html((doo=='add'?'Thêm':'Sửa')+' loại thu')
                    $('.k-window-cashgroup .ng-binding.control-label:nth(0)').html('Loại thu')
                     
                }
                
                if(group.id>0)
                    $('.k-window-cashgroup [ng-show="group.Id>0"]').removeClass('ng-hide')
                else
                    $('.k-window-cashgroup [ng-show="group.Id>0"]').addClass('ng-hide')
                      
                //thu false chi true
                if(doo=='add')
                    $('.k-window-cashgroup [ng-model],.k-window-cashgroup [k-ng-model]').val('')
                else{
                    $('.k-window-cashgroup [ng-model="group.Name"]').val(group.name)
                     
                    $('.k-window-cashgroup [ng-model="group.Description"]').val(group.note)
                    
                    setUsed(group.used,'cashgroup','group')   
                }
                
                
                $('.k-window-cashgroup').css({
                            'display': 'block', 
                            'z-index': 1002
                        })
                $('.main>.k-overlay').css({
                    display:'block',
                    'z-index': 1001
                })
                $('.k-window-cashgroup .k-i-close,.k-window-cashgroup [ng-click="cancel()"]').unbind('click')
                $('.k-window-cashgroup .k-i-close,.k-window-cashgroup [ng-click="cancel()"]').click(function(e){
                    $('.k-window-cashgroup').hide()
                    $('.main>.k-overlay').css({
                        'z-index': 999    
                    })
                     
                    return false
                })
                
                //prettycheckbox
                if(doo=='add')
                    setUsed(1,'cashgroup','group')   
                else{
                    console.log('group.used:',group.used)
                    setUsed(group.used,'cashgroup','group')   
                }
                    
                //console.log('setUsedsetUsedsetUsedsetUsed',setUsed)
                 
                $('.k-window-cashgroup .prettycheckbox>input + a + label,.k-window-cashgroup .prettycheckbox>input + a').unbind('click')
                $('.k-window-cashgroup .prettycheckbox>input + a + label,.k-window-cashgroup .prettycheckbox>input + a').click(function(e){
                    $('.k-window-cashgroup .prettycheckbox>input + a + label,.k-window-cashgroup .prettycheckbox>input + a').toggleClass('checked')
                    console.log($(this).siblings('input')) 
                    if($(this).hasClass('checked')){
                        $(this).siblings('input').attr('checked','checked')
                        group.used = 1
                    }else{
                        $(this).siblings('input').removeAttr('checked')
                        group.used = 0
                    }
                })
                
                                              
                
                $('.k-window-cashgroup [ng-model="group.Name"]').unbind('blur')
                $('.k-window-cashgroup [ng-model="group.Name"]').blur(function(e){
                    group.name = $(this).val().trim()    
                })
                
                $('.k-window-cashgroup [ng-model="group.Description"]').unbind('blur')
                $('.k-window-cashgroup [ng-model="group.Description"]').blur(function(e){
                    group.note = $(this).val().trim()    
                })
                
                if(doo=='edit'){
                    $('.k-window-cashgroup [ng-click="delete()"]').unbind('click')
                    $('.k-window-cashgroup [ng-click="delete()"]').click(function(e){
                        //khi xoa update het cac invoice 7,8 co cashflowtype = kia ve 0 het
                        
                        //hien bang popup
                        $('.main>.k-overlay').css({
                            'z-index':1003
                        })
                        $('.main>.k-window-alert').show()
                        $('.main>.k-window-alert').css({
                            top: ($(window).height()-$('.main>.k-window-alert').height())/2+window.scrollY,
                            left: ($(window).width()-$('.main>.k-window-alert').width())/2,
                            'z-index':1004
                        })
                        $('.main>.k-window-alert .k-window-title').html('Xóa loại thu/chi')
                        $('.main>.k-window-alert .confirm-message').html('Bạn chắc chắn muốn xóa loại thu/chi?')
                        
                        $('.main>.k-window-alert .k-i-close,.main>.k-window-alert [ng-enter="onCancel()"]').unbind('click')
                        $('.main>.k-window-alert .k-i-close,.main>.k-window-alert [ng-enter="onCancel()"]').click(function(e){
                            $('.main>.k-window-alert').hide()
                            $('.main>.k-overlay').css({
                                'z-index': 1001    
                            })
                             
                            return false
                        })
                        $('.main>.k-window-alert [ng-enter="onConfirm()"]').unbind('click')
                        $('.main>.k-window-alert [ng-enter="onConfirm()"]').click(function(e){
                            //ajax delete
                            //khi xoa update het cac invoice 8,9 co cashflowtype = kia ve 0 het
                            $.ajax('ajax.php?action=delete_bill_type',{
                                data: 'id='+group.id,
                                method: "POST",
                                dataType: 'json',
                                success: function(d){
                                     //console.log(d)
                                     if(d.error){
                                         toastr.warning('Có lỗi xảy ra')
                                     }else{
                                         $('.main>.k-window-alert .k-i-close').click()
                                         $('.k-window-cashgroup .k-i-close').click()
                                         
                                         for(var i in bill_types){
                                            if(bill_types[i].id==group.id){
                                                bill_types.splice(i,1)
                                                break;
                                            }
                                         }
                                         saveCacheBillTypes()
                                         item.cashflowtype = 0;
                                         $('.k-window-cashflow .k-dropdown:nth(0) .k-input').html($('#ddlCashflowGroup option[value="0"]').html())
                                         //delete 1 option
                                         $('#ddlCashflowGroup option[value="'+group.id+'"]').remove()
                                         
                                         toastr.success('Xóa thành công') 
                                         
                                         //khi xoa update het cac invoice 8,9 co cashflowtype = kia ve 0 het
                                         for(var i in invoices){
                                            if(invoices[i].type==8||invoices[i].type==9){
                                                if(invoices[i].cashflowtype==group.id){
                                                    invoices[i].cashflowtype = 0
                                                }    
                                            }
                                         }
                                         saveCacheInvoices_cashflows(invoices)
                                         //can thi display lai: loadTableLeft
                                     }
                                },
                                error:function(e){
                                    console.log(e)
                                    toastr.warning('Có lỗi xảy ra')
                                }
                            })
                            return false
                        })
                        
                        return false;
                    })
                }
                
                $('.k-window-cashgroup [ng-click="saveCashgroup()"]').unbind('click')
                $('.k-window-cashgroup [ng-click="saveCashgroup()"]').click(function(e){
                    //thu 1, chi 2
                    //thu false chi true
                    if(doo=='add')
                        group.type = x?2:1;
                    $('.k-window-cashgroup [ng-model]').blur()
                    
                    console.log(group);//return false;
                    
                    if(group.name==''){
                        toastr.warning('Bạn chưa điền loại '+(x?'chi':'thu'))
                        return false
                    }                    
                    
                    $.ajax('ajax.php?action=bill_type',{
                        data: 'data='+JSON.stringify(group),
                        method: "POST",
                        dataType: 'json',
                        success: function(d){
                             //console.log(d)
                             if(d.error){
                                 toastr.warning('Có lỗi xảy ra')
                             }else{
                                 $('.k-window-cashgroup .k-i-close').click()
                                 if(group.id>0){//doo=='edit'
                                    //bill_types[item.cashflowtype] = group
                                    var ob = loadObject(item.cashflowtype,bill_types)
                                    console.log('obobob',ob)
                                    ob = $.extend(ob,group)
                                     saveCacheBillTypes()
                                     setUsed(group.used);
                                    
                                    //update new name: select option (va ul li: k can nua, no tu update)
                                    $('.k-window-cashflow .k-dropdown:nth(0) .k-input').html(ob.name)
                                    $('#ddlCashflowGroup option[value="'+ob.id+'"]').html(ob.name)
                                    console.log('eeeeeeddddddddiiiiitttt' )
                                 }else{
                                     var ob = $.extend({},group,{id:d.id})
                                     bill_types.push(ob)
                                     saveCacheBillTypes()
                                     
                                     //update dropdown loaithuchi, va setvalue ob.id, item.cashflowtype = ob.id
                                     cf(ob.id);
                                     setUsed(ob.used);
                                     console.log('aaaaaaaaaddddđ')
                                 }
                             }
                        },
                        error:function(e){
                            console.log(e)
                            toastr.warning('Có lỗi xảy ra')
                        }
                    })
                    
                    return false;
                })
            })
            //alert(item.partner)
            //autocomplete partner
            if(item.partner>0){ 
                var zh = eval(typehds2[item.partnertype]+"s")
                var ob = loadObject(item.partner,zh)
                afterClick(ob,x)
            }else{
                $('.k-window-cashflow [ng-show="item.PartnerId"]').addClass('ng-hide')
            }
            $('#partnerSearchInput').keyup(function(e){
                var v = $(this).val().toLowerCase()
                 
                if(v.length>0){
                    var cp = $(this).next()
                    cp.removeClass('ng-hide')
                    
                    var h = []
                    var zh = eval(typehds2[item.partnertype]+"s")
                    
                    for(var i in zh){
                        
                        if(zh[i].name.toLowerCase().indexOf(v)>=0 ||
                           zh[i].email.toLowerCase().indexOf(v)>=0 || 
                           zh[i].phone.toLowerCase().indexOf(v)>=0){
                            h.push(zh[i])
                        }
                    }
                    
                    cp.find('ul').html('')
                    
                    if(h.length){
                        for(var i in h){
                            var suggestion = h[i];
                            var $index = i
                            
                            var _productSearchItemTempl = partnerSearchTempl+''
                            var ret2x = {}
                            
                            var mx = _productSearchItemTempl.match(/\{\{([^\}]+)\}\}/g)
                            for(var k=0;k<mx.length;k++){
                                 
                                var rt = mx[k].substr(2,mx[k].length-4)
                                if(rt.match(/\|/) && !rt.match(/\|\|/)){
                                    var tr = rt.split('|')
                                    if(tr[1].match(/\:/)){
                                        var tr1 = tr[1].split(':')
                                        var tr11 = tr1.shift()
                                        rt = tr11+"("+tr[0]+","+tr1.join(',')+")"
                                    }else{
                                        rt = tr[1]+"("+tr[0]+")"
                                    }
                                }
                                console.log(rt)
                                ret2x[mx[k]] = eval(rt)
                                _productSearchItemTempl = _productSearchItemTempl.replace(mx[k],ret2x[mx[k]]==null?'':ret2x[mx[k]])
                            } 
                             
                            var ll = $(_productSearchItemTempl)
                            ll.hover(function(){
                                $(this).addClass('active')
                            },function(){
                                $(this).removeClass('active')
                            })
                            
                            ll.click(function(e){
                                var ii = $(this).attr('index')
                                var ob = h[ii]
                                console.log(ob)
                                
                                afterClick(ob,x)
                                
                                $(this).parent().parent().addClass('ng-hide')
                            })
                            
                            if(e.which==13){
                                ll.click()
                                //cp.addClass('ng-hide')
                                break
                            }
                            
                            cp.find('ul').append(ll)
                        }
                        
                        cp.find('ul').unbind('hover')
                        cp.find('ul').hover(function(){
                            
                        },function(){
                            $(this).parent().addClass('ng-hide')
                        })
                        
                        cp.find('.autoNotFound').addClass('ng-hide')
                        cp.find('ul').removeClass('ng-hide')
                    }else{
                        cp.find('ul').addClass('ng-hide')
                        cp.find('.autoNotFound').removeClass('ng-hide')
                    }
                }
            })
            
            //alert(item.id)
            //xoa phieu
            if(item.id!=undefined && item.status!=2){
                $('.k-window-cashflow [ng-show="item.Id && rights.canDelete"]').removeClass('ng-hide')
                $('.k-window-cashflow [ng-click="voidPayment(item.Code,item.Value)"]').unbind('click')
                $('.k-window-cashflow [ng-click="voidPayment(item.Code,item.Value)"]').click(function(e){
                    //chi co 2 truong hop type=8,9 phieu thu phieu chi thoi
                    
                    //hien bang popup
                    $('.main>.k-overlay').css({
                        'z-index':1003
                    })
                    $('.main>.k-window-alert').show()
                    $('.main>.k-window-alert').css({
                        top: ($(window).height()-$('.main>.k-window-alert').height())/2+window.scrollY,
                        left: ($(window).width()-$('.main>.k-window-alert').width())/2,
                        'z-index':1004
                    })
                    $('.main>.k-window-alert .k-window-title').html('Hủy phiếu thanh toán')
                    $('.main>.k-window-alert .confirm-message').html('Bạn chắc chắn hủy phiếu <strong>'+item.code+'</strong> này không?')
                    
                    $('.main>.k-window-alert .k-i-close,.main>.k-window-alert [ng-enter="onCancel()"]').unbind('click')
                    $('.main>.k-window-alert .k-i-close,.main>.k-window-alert [ng-enter="onCancel()"]').click(function(e){
                        $('.main>.k-window-alert').hide()
                        $('.main>.k-overlay').css({
                            'z-index': 999    
                        })
                         
                        return false
                    })
                    $('.main>.k-window-alert [ng-enter="onConfirm()"]').unbind('click')
                    $('.main>.k-window-alert [ng-enter="onConfirm()"]').click(function(e){
                    
                    
                        //ajax
                        $.ajax('ajax.php?action=delete_cashflow',{
                            data: 'id='+item.id,
                            method: "POST",
                            dataType: 'json',
                            success: function(d){
                                 //console.log(d)
                                 if(d.error){
                                     toastr.warning('Có lỗi xảy ra')
                                 }else{
                                    
                                     $('.main>.k-window-alert .k-i-close').click()
                                    
                                     $('.main>.k-window-cashflow .k-i-close').click()
                                      
                                     var ob = loadObject(item.id,invoices)
                                     ob.status=2;
                                     saveCacheInvoices_cashflows(invoices)
                                     
                                     console.log('hoi ha hoi ha 2',ob)
                                      
                                     loadTables()
                                     
                                     toastr.success('Xóa thành công') 
                                      
                                 }
                            },
                            error:function(e){
                                console.log(e)
                                toastr.warning('Có lỗi xảy ra')
                            }
                        })
                        //alert(item.id)
                        console.log('hoi ha hoi ha')
                        return false
                    })
                    return false
                })
            }
                
            else
                $('.k-window-cashflow [ng-hide="disabled || !rights.canDelete"]').addClass('ng-hide')
            
            
        }
         
        function loadTables(){
            
            console.log('loadTables');
            
            if(invoices===null || !vkl){
                setTimeout(function(){loadTables()},500)
                return false;
            }
            
            
            if(vkl['6.1.1']==undefined)
                $('#grdBranchs').addClass('ng-hide')
            if(vkl['6.1.2']==undefined)
                $('[onclick="createItem()"],[onclick="createItem(true)"]').addClass('ng-hide')
            
            templBranch = $('#templBranch').html();
            templProductInvoice = $('#templProductInvoice').html()
            
            $('#grdBranchs>.k-grid-content>table>tbody').html('');
            
            var counttables = 0, countTableForGroup=0;
            
            var tongthu=0 , tongchi = 0, duquydauky = 0;
            
            for(var i in invoices){
                
                if(filter.financialFilter>-1){
                    if(filter.financialFilter!=invoices[i].used){
                        continue;
                    }
                }
                
                if(filter.status.indexOf(parseInt(invoices[i].status))==-1) continue;
                
                if(loaihds[invoices[i].type]==undefined) continue;
                
                if(filter.type.indexOf(loaihds[invoices[i].type][2])==-1) continue;
                
                if(filter.description!=''){
                    if(invoices[i].note.toLowerCase().indexOf(filter.description.toLowerCase())==-1) continue;
                }
                
                if(filter.keywordParam!=''){
                    if(invoices[i].code.toLowerCase().indexOf(filter.keywordParam.toLowerCase())==-1) continue;
                }
                
                //09/22/2019
                if(CashFlowType==0){
                    if(invoices[i].payment!=0) continue;   
                }else if(CashFlowType==1){
                    if(invoices[i].payment==0||invoices[i].payment==4) continue;
                    //check filter.bankAccId
                }else{
                    
                }
                
                //2019 filter by range
                if(filter.range){
                    var filterrange = filter.range.split('-')
                    var date2 = moment(new Date(invoices[i].date)).format('YYYY-MM-DD')
                    
                    filterrange[0] = moment(filterrange[0],'DD/MM/YYYY').format('YYYY-MM-DD')
                    filterrange[1] = moment(filterrange[1],'DD/MM/YYYY').format('YYYY-MM-DD')
                    
                    if(date2<filterrange[0] || date2>filterrange[1]) {
                        
                        if(date2<filterrange[0] && invoices[i].status==1){
                            if(loaihds[invoices[i].type]==undefined) continue;
                             
                            if(loaihds[invoices[i].type][2]==2){
                                duquydauky -= ((invoices[i].type==8||invoices[i].type==9)? invoices[i].price: invoices[i].paying)
                            }else{
                                duquydauky -= -((invoices[i].type==8||invoices[i].type==9)? invoices[i].price: invoices[i].paying)
                            }
                        }
                        continue;
                    }
                    
                    
                    
                }
                
                countTableForGroup++;
                
                if(invoices[i].status==1){
                    if(loaihds[invoices[i].type][2]==2){
                        tongchi -= (invoices[i].type==8||invoices[i].type==9)? invoices[i].price: invoices[i].paying
                    }else{
                        tongthu -= -((invoices[i].type==8||invoices[i].type==9)? invoices[i].price: invoices[i].paying)
                    }
                }
                
                if(countTableForGroup>cpage*record && countTableForGroup <= (cpage+1)*record){
                 
                    templBranch2 = templBranch+"";
                    
                    var dataItem = $.extend({},invoices[i])
                    var ret2x = {}
                    //var $index = i
                    
                    if(i%2==1) dataItem.class = 'k-alt';
                    else dataItem.class = '';
                    
                    
                     
                    var mx = templBranch2.match(/\{\{([^\}]+)\}\}/g)
                    for(var k=0;k<mx.length;k++){
                         
                        var rt = mx[k].substr(2,mx[k].length-4)
                        if(rt.match(/\|/) && !rt.match(/\|\|/)){
                            var tr = rt.split('|')
                            if(tr[1].match(/\:/)){
                                var tr1 = tr[1].split(':')
                                var tr11 = tr1.shift()
                                rt = tr11+"("+tr[0]+","+tr1.join(',')+")"
                            }else{
                                rt = tr[1]+"("+tr[0]+")"
                            }
                        }
                        console.log(rt)
                        ret2x[mx[k]] = eval(rt)
                        templBranch2 = templBranch2.replace(mx[k],ret2x[mx[k]]==null?'':ret2x[mx[k]])
                    } 
                    //console.log(ret2x)
                    var ll = $(templBranch2)
                     
                    
                    $('#grdBranchs>.k-grid-content>table>tbody').append(ll);
                
                }
            }
            $('.cashTop ul li font:nth(0)').html(formatCurrency(duquydauky))
            $('.cashTop ul li font:nth(1)').html(formatCurrency(tongthu))
            $('.cashTop ul li font:nth(2)').html(formatCurrency(tongchi))
            $('.cashTop ul li font:nth(3)').html(formatCurrency(duquydauky+tongthu+tongchi))
             
            templBranchDetail = $('#templBranchDetail').html();
            templUsersInBranch = $('#templUsersInBranch').html();
            $('#grdBranchs>.k-grid-content>table>tbody>tr>td:not(:first-child)').unbind('click')
            $('#grdBranchs>.k-grid-content>table>tbody>tr>td:not(:first-child)').click(function(){
                $(this).parent().find('>.k-hierarchy-cell>.k-icon').trigger('click');
            });
            $('#grdBranchs>.k-grid-content>table>tbody>tr>.k-hierarchy-cell>.k-icon').unbind('click')
            $('#grdBranchs>.k-grid-content>table>tbody>tr>.k-hierarchy-cell>.k-icon').click(function(){
                fixedfixed()
                templBranchDetail2 = templBranchDetail+"";
                n2= $(this).parent().parent();
                n = n2.next();
                //console.log(n);
                
                if($(this).hasClass('k-plus')){
                    //an het detail
                    $(this).parent().parent().siblings('.k-detail-row').hide();
                    //thay doi icon
                    $(this).parent().parent().parent().find('>tr>.k-hierarchy-cell>.k-icon').removeClass('k-minus');
                    $(this).parent().parent().parent().find('>tr>.k-hierarchy-cell>.k-icon').addClass('k-plus');
                    
                    if(n.hasClass('k-detail-row')){
                        n.show();
                    }else{
                         
                        //prepare content
                        //find uid
                        uid = n2.attr('data-uid');
                        b = loadInvoice(uid); 
                         
                        //console.log(b) 
                        
                        var dataItem = $.extend({},b)
                         
                        var ret2x = {}
                        //var $index = i
                         
                        var mx = templBranchDetail2.match(/\{\{([^\}]+)\}\}/g)
                        for(var k=0;k<mx.length;k++){
                             
                            var rt = mx[k].substr(2,mx[k].length-4)
                            if(rt.match(/\|/) && !rt.match(/\|\|/)){
                                var tr = rt.split('|')
                                if(tr[1].match(/\:/)){
                                    var tr1 = tr[1].split(':')
                                    var tr11 = tr1.shift()
                                    rt = tr11+"("+tr[0]+","+tr1.join(',')+")"
                                }else{
                                    rt = tr[1]+"("+tr[0]+")"
                                }
                            }
                            console.log(rt)
                            ret2x[mx[k]] = eval(rt)
                            templBranchDetail2 = templBranchDetail2.replace(mx[k],ret2x[mx[k]]==null?'':ret2x[mx[k]])
                        } 
                        //console.log(ret2x)
                        var ll = $(templBranchDetail2)
                         
                        ll.find('[ng-click="exportDetail()"]').click(function(e){
                            toastr.info("Chức năng đang phát triển")
                        })
                        ll.find('[ng-click="printContent()"]').click(function(e){
                            inhoadon(dataItem)
                        })
                        ll.find('[ng-click="cancel()"]').click(function(e){
                            toastr.warning("Chức năng này tạm khóa")
                            return false;
                             
                            $('.main>.k-overlay').show()
                            $('.main>.k-window-alert').show()
                            $('.main>.k-window-alert').css({
                                top: ($(window).height()-$('.main>.k-window-alert').height())/2+window.scrollY,
                                left: ($(window).width()-$('.main>.k-window-alert').width())/2
                            })
                            return false;
                        })
                        ll.find('[ng-click="openTransaction(dataItem)"]').click(function(e){
                            //alert(dataItem.type)
                            switch(parseInt(dataItem.type)){
                                
                                case 2: //hoa don tt ban hang
                                case 18: //hoa don tt dat hang
                                     
                                case 4: //hoa don tt nhap hang
                                    
                                case 6: //hoa don tt tra hang nhap
                                
                                case 12: //hoa don tt tra hang
                                    paymentDetail(dataItem)
                                break;
                                
                                case 8:
 
                                case 9:
                                    createItem(dataItem.type-8,dataItem)    
                                break
                                    
                            }
                        })
                        
                        
                         
                        n2.after(ll);
                        tabstrip();
                    }
                    
                     
                    $(this).removeClass('k-plus');
                    $(this).addClass('k-minus');
                }else{
                    
                    n.hide();
                    
                    $(this).addClass('k-plus');
                    $(this).removeClass('k-minus');
                }
            });
            
            if(countTableForGroup==1){
                $('#grdBranchs>.k-grid-content>table>tbody>tr:not(.cssSummaryRow)>.k-hierarchy-cell>.k-icon:nth(0)').click()
            }
            
            tpage = Math.ceil(countTableForGroup/record);
            
            $('#grdBranchs > .paging-box .k-label').html("Hiển thị "+((cpage)*record+1)+" - "+Math.min(countTableForGroup,(cpage+1)*record)+" trên tổng số "+countTableForGroup+" phiếu thu/chi");
            
            $('#grdBranchs > .paging-box a').removeClass('k-state-disabled');
            
            if(cpage==0){
                $('#grdBranchs > .paging-box a:nth(0)').addClass('k-state-disabled');
                $('#grdBranchs > .paging-box a:nth(1)').addClass('k-state-disabled');
            } 
            
            if(cpage==tpage-1){
                $('#grdBranchs > .paging-box a:nth(2)').addClass('k-state-disabled');
                $('#grdBranchs > .paging-box a:nth(3)').addClass('k-state-disabled');
            } 
            
            $('#grdBranchs > .paging-box .k-state-selected, #grdBranchs > .paging-box .k-current-page span').html(cpage+1);
            $('#grdBranchs > .paging-box a:nth(0)').unbind('click')
            //first page click
            $('#grdBranchs > .paging-box a:nth(0)').click(function(){
                cpage = 0;
                loadTables();
            }); $('#grdBranchs > .paging-box a:nth(1)').unbind('click')
            $('#grdBranchs > .paging-box a:nth(1)').click(function(){
                cpage -= 1;
                if(cpage>=0)
                loadTables();
                else cpage=0
            }); $('#grdBranchs > .paging-box a:nth(2)').unbind('click')
            $('#grdBranchs > .paging-box a:nth(2)').click(function(){
                cpage += 1;
                if(cpage<tpage)
                loadTables();
                else
                cpage = tpage-1
            }); $('#grdBranchs > .paging-box a:nth(3)').unbind('click')
            $('#grdBranchs > .paging-box a:nth(3)').click(function(){
                cpage = tpage-1;
                loadTables();
            });
            
        }
         
        $(document).ready(function(){
            $('.addProductBtn [ng-click="export()"],.addProductBtn [ng-click="exportDetail()"]').click(function(e){
                toastr.info("Chức năng này đang phát triển")
            })
            
            //tooltip
            $('[data-toggle="tooltip"]').tooltip()
            
            setTitle(loadBranch(cb).name+' - Sổ quỹ tiền mặt') 
            $('[data-role="draggable"]').draggable()
            
            partnerSearchTempl = $('#partnerSearchTempl').html()
        })
         
    </script>


<div class="k-animation-container" style="width: 206px; height: 116px; margin-left: 0px; padding-left: 0px; padding-right: 0px; padding-bottom: 0px; display: none; box-sizing: content-box; position: absolute; top: 471px; z-index: 10002; left: 735.984px;">
  <div class="k-list-container k-popup k-group k-reset" data-role="popup" style="position: absolute; font-size: 13px; font-family: Arial, Helvetica, sans-serif; font-stretch: normal; font-style: normal; font-weight: normal; line-height: normal; width: 203.984px; height: auto; display: none; transform: translateY(-116px);"><span class="k-list-filter"><span unselectable="on" class="k-icon k-i-search">select</span></span>
    <div
    class="k-group-header" style="display:none"></div>
  <div class="k-list-scroller" unselectable="on" style="height: auto;">
    <ul unselectable="on" class="k-list k-reset" tabindex="-1" aria-hidden="true" aria-live="polite" data-role="staticlist" role="listbox">
      <li tabindex="-1" role="option" unselectable="on" class="k-item ng-scope k-state-selected k-state-focused" data-offset-index="0" id="6c5ce9a1-429a-43fd-a0ac-1057fb2516c9">trần đình đàn</li>
      <li tabindex="-1" role="option" unselectable="on" class="k-item ng-scope" data-offset-index="1">Hoàng - Kinh Doanh</li>
      <li tabindex="-1" role="option" unselectable="on" class="k-item ng-scope" data-offset-index="2">Hương - Kế Toán</li>
    </ul>
  </div>
</div>
</div>

<div class="k-overlay" style="display: none; z-index: 10002; opacity: 0.5;"></div>
<div class="k-widget k-window k-window-poup k-window-masstel k-window-alert kv-window kv-close-popup window-error" data-role="draggable" style="padding-top: 42px; min-width: 90px; min-height: 50px; width: 500px; display: none; top: 1175px; left: 429px; touch-action: pan-y; z-index: 10003; opacity: 1; transform: scale(1);">
  <div class="k-window-titlebar k-header" style="margin-top: -42px;">&nbsp;<span class="k-window-title">Hủy hóa đơn</span>
    <div class="k-window-actions"><a role="button" href="#" class="k-window-action k-link"><span role="presentation" class="k-icon k-i-close">Close</span></a></div>
  </div>
  <div data-role="window" class="k-window-content k-content" tabindex="0">
    <div class="form-wrapper">
      <div class="form-group">
        <p class="confirm-message">Bạn có chắc chắn muốn hủy hóa đơn <strong>HD000036</strong> này không?</p>
      </div>
    </div>
    <div class="kv-window-footer">
      <button class="btn-confirm kv2Btn" ng-enter="onConfirm()" ng-hide="noYes"><i class="fa fa-check"></i>Đồng ý</button>
      <button class="btn-cancel kv2Btn kv2BtnYellow" ng-enter="onCancel()"><i class="fa fa-ban"></i>Bỏ qua</button>
    </div>
  </div>
</div>

<div class="k-widget k-window k-window-poup k-window-poup-bt k-window-fix k-window-cashflow kv-window" data-role="draggable" style="padding-top: 42px; min-width: 90px; min-height: 50px; width: 620px; display: none; top: 0px; left: 369px; position: fixed; touch-action: pan-y; z-index: 10005; transform: scale(1); opacity: 1;">
  <div class="k-window-titlebar k-header" style="margin-top: -42px;">&nbsp;<span class="k-window-title">Lập phiếu thu</span>
    <div class="k-window-actions"><a role="button" href="#" class="k-window-action k-link"><span role="presentation" class="k-icon k-i-close">Close</span></a></div>
  </div>
  <div kendo-window="cashflowWindow" k-visible="false" k-resizable="false" k-draggable="true" k-pinned="true" k-width="620" k-modal="true" data-role="window" class="k-window-content k-content" tabindex="0" style="display: block;">
    <kv-cashflow-form form-name="cashflowForm" kv-width="620" class="ng-isolate-scope">
      <div class="form-wrapper">
        <div class="form-group">
          <label class="form-label control-label ng-binding">Mã phiếu</label>
          <div class="form-wrap">
            <input type="text" class="form-control iptFocus ng-pristine ng-valid ng-empty ng-touched" ng-model="item.Code" placeholder="Mã phiếu tự động" ng-disabled="item.Id">
          </div>
        </div>
        <div class="form-group">
          <label class="form-label control-label ng-binding">Thời gian</label>
          <div class="form-wrap"><span class="k-widget k-datetimepicker k-header"><span class="k-picker-wrap k-state-default"><input kendo-date-time-picker="" placeholder="03/08/2017 21:50" k-ng-model="item.PaymentDate" k-format="'dd/MM/yyyy HH:mm'" k-time-format="'HH:mm'" data-role="datetimepicker" type="text" class="k-input" role="combobox" aria-expanded="false" aria-disabled="false" aria-readonly="false" style="width: 100%;"><span unselectable="on" class="k-select"><span unselectable="on" class="k-icon k-i-calendar" role="button">select</span>
            <span
            unselectable="on" class="k-icon k-i-clock" role="button">select</span>
              </span>
              </span>
              </span>
          </div>
        </div>
        <div class="form-group">
          <label class="form-label control-label ng-binding">Loại thu</label>
          <div class="form-wrap wrap-inside-btn"><span title="" class="k-widget k-dropdown k-header mainSelect ng-pristine ng-untouched ng-valid ng-empty" unselectable="on" role="listbox" aria-haspopup="true" aria-expanded="false" tabindex="0" aria-owns="ddlCashflowGroup_listbox" aria-disabled="false"
            aria-readonly="false" aria-busy="false" style="" aria-activedescendant="1044790c-9a80-4cbf-9701-ac83635e04f0"><span unselectable="on" class="k-dropdown-wrap k-state-default"><span unselectable="on" class="k-input ng-scope">--Chọn thu nhập khác--</span>
            <span
            unselectable="on" class="k-select"><span unselectable="on" class="k-icon k-i-arrow-s">select</span></span>
              </span>
              <select id="ddlCashflowGroup" k-data-source="cashflowGroups" k-on-change="ddlcashflowGroupsChange()" ng-model="SelectedCashFlowGroupId" k-ng-model="currentCashflowGroup" k-data-bound="onDataBound" class="mainSelect ng-pristine ng-untouched ng-valid ng-empty"
              k-data-text-field="'Name'" k-data-value-field="'Id'" kendo-drop-down-list="" data-role="dropdownlist" style="display: none;">
                <option value="null">--Chọn thu nhập khác--</option>
              </select>
              </span><a ng-click="addCashflowGroup()" href="javascript:void(0)" class="iptBtn" title="Thêm loại thu"><i class="fa fa-plus"></i></a> <a ng-click="updateCashGroup()" href="javascript:void(0)" class="iptBtn ng-hide" ng-show="SelectedCashFlowGroupId &amp;&amp; SelectedCashFlowGroupId!='null'"
              title="Sửa loại thu"><i class="fa fa-pencil-square-o"></i></a></div>
        </div>
        <div class="form-group">
          <label class="form-label control-label ng-binding">Nhóm người nộp</label>
          <div class="form-wrap"><span title="" class="k-widget k-dropdown k-header mainSelect" unselectable="on" role="listbox" aria-haspopup="true" aria-expanded="false" tabindex="0" aria-owns="ddlCashflowType_listbox" aria-disabled="false" aria-readonly="false" aria-busy="false"
            aria-activedescendant="a141308f-5fb0-4496-afc3-50ede4c6c325" style=""><span unselectable="on" class="k-dropdown-wrap k-state-default"><span unselectable="on" class="k-input ng-scope">Khác</span><span unselectable="on" class="k-select"><span unselectable="on" class="k-icon k-i-arrow-s">select</span></span>
            </span>
            <select id="ddlCashflowType" k-data-source="partnerTypes" k-on-change="partnerTypeChanged()" k-ng-model="item.PartnerType" k-data-text-field="'label'" k-data-value-field="'value'" k-value-primitive="true" class="mainSelect" kendo-drop-down-list=""
            ng-disabled="item.Id" data-role="dropdownlist" style="display: none;">
              <option value="C">Khách hàng</option>
              <option value="S">Nhà cung cấp</option>
              <option value="U">Nhân viên</option>
              <option value="O" selected="selected">Khác</option>
            </select>
            </span>
          </div>
        </div>
        <div ng-hide="item.Id" class="form-group">
          <label class="form-label control-label ng-binding">Tên người nộp</label>
          <div class="form-wrap wrap-inside-btn"><span><autocomplete class="cash-autocomplete1 w100 ng-pristine ng-untouched ng-valid ng-isolate-scope ng-empty" ng-model="partnerSearchTerm" attr-placeholder="Tìm kiếm" template-id="partnerSearchTempl" attr-inputid="partnerSearchInput" title="" data="partners" on-type="searchTermChanged" on-select="partnerSelected"><div class="autocomplete " id=""><input type="text" ng-model="searchParam" placeholder="Tìm kiếm" class="ng-empty form-control" id="partnerSearchInput" tabindex="" ng-disabled="kvDisable" kv-select-text=""><div ng-show="completing" class="ng-hide"><ul><!-- ngRepeat: suggestion in suggestions track by $index --></ul><div class="autoNotFound ng-hide" ng-show="searchParam &amp;&amp; suggestions.length == 0">Không tìm thấy kết quả nào phù hợp</div></div></div></autocomplete><a ng-click="addPartner()" href="javascript:void(0)" class="iptBtn" ng-show="item.PartnerType == 'O'" title="Thêm người nộp"><i class="fa fa-plus"></i></a></span></div>
        </div>
        <div ng-show="" class="ng-hide"></div>
        <div ng-show="item.PartnerId" class="form-group ng-hide">
          <label class="form-label control-label ng-binding ng-hide" ng-show="item.Id">Tên người nộp</label>
          <div class="form-wrap wrap-inside-btn"><span class="ng-binding"><a style="margin-left: -10px" ng-click="updatePartner()" ng-show="item.PartnerType == 'O' &amp;&amp; item.PartnerId" href="javascript:void(0)" class="icon edit" title="Sửa người nộp"><i class="fa fa-pencil-square-o"></i></a> <a style="margin-right: 5px; height: 19px; width: 0;" href="javascript:void(0)" ng-show="item.PartnerId &amp;&amp; !item.Id" ng-click="removePartner()" class="icon del" title="Xóa người nộp"></a> <strong class="dpib clb ng-binding" style="line-height: 30px"><span ng-hide="item.PartnerId || item.Id"></span>            </strong>&nbsp;&nbsp;</span>
          </div>
        </div>
        <div class="form-group">
          <label class="form-label control-label ng-binding">Giá trị</label>
          <div class="form-wrap">
            <input class="form-control text-right ng-pristine ng-untouched ng-valid ng-not-empty" kv-auto-numeric="{mDec:0}" ng-model="item.Value" type="text">
          </div>
        </div>
        <div ng-show="method === 'bank'" id="ddlBankAccount" class="form-group ng-hide">
          <label class="form-label control-label ng-binding">Tài khoản nhận</label>
          <div class="form-wrap wrap-inside-btn"><span title="" class="k-widget k-dropdown k-header iptR" unselectable="on" role="listbox" aria-haspopup="true" aria-expanded="false" tabindex="0" aria-owns="" aria-disabled="false" aria-readonly="false" aria-busy="false" style=""><span unselectable="on" class="k-dropdown-wrap k-state-default"><span unselectable="on" class="k-input ng-binding ng-scope"></span>
            <span
            unselectable="on" class="k-select"><span unselectable="on" class="k-icon k-i-arrow-s">select</span></span>
              </span>
              <input class="iptR" kendo-drop-down-list="" k-data-source="accounts" k-data-text-field="'Account'" k-data-value-field="'Id'" k-ng-model="SelectedAccountId" k-value-primitive="true" type="text" k-options="customOptions" data-role="dropdownlist"
              style="display: none;">
              </span> <a ng-click="addBankAccount()" href="javascript:void(0)" class="iptBtn" ng-hide="SelectedAccountId" title="Thêm tài khoản nhận"><i class="fa fa-plus"></i></a> <a ng-click="updateBankAccount()" href="javascript:void(0)" class="iptBtn ng-hide"
              ng-show="SelectedAccountId" title="Sửa tài khoản nhận"><i class="fa fa-pencil-square-o"></i></a></div>
        </div>
        <div class="form-group">
          <label class="form-label control-label ng-binding">Ghi chú</label>
          <div class="form-wrap">
            <textarea class="form-control ng-pristine ng-untouched ng-valid ng-empty" rows="5" ng-model="item.Description"></textarea>
          </div>
        </div>
        <div class="form-group">
          <div class="form-wrap">
            <aside class="frRadioCheck dpb fll has-pretty-child">
              <div class="clearfix prettycheckbox labelright  blue">
                <input type="checkbox" ng-checked="item.UsedForFinancialReporting" name="financial" kv-pretty-check="" ng-model="item.UsedForFinancialReporting" kv-change="useforReportChanged" kv-disabled="item.PartnerType == 'C' || item.PartnerType == 'S'"
                kv-data-label="_l.cashflow_UsetoReport" class="ng-pristine ng-untouched ng-valid ng-isolate-scope ng-not-empty" data-label="Hạch toán vào kết quả hoạt động kinh doanh" style="display: none;" checked="checked">
                <a href="javascript:void(0)" tabindex="1000007" class="checked"></a>
                <label for="undefined" class="checked">Hạch toán vào kết quả hoạt động kinh doanh</label>
              </div>
            </aside>
            <a href="javascript:void(0)" tabindex="0" class="help icon" kv-tooltip="" data-toggle="tooltip" data-placement="right" data-original-title="Chọn trong trường hợp giá trị này là khoản Thu nhập thêm hoặc Chi phí vận hành, phát sinh của cửa hàng. Không chọn trong trường hợp Thu tiền hàng hoặc Trả tiền nhà cung cấp."><i class="fa fa-info-circle"></i></a>
          </div>
        </div>
      </div>
      <div class="kv-window-footer"><a href="javascript:void(0)" class="kv2Btn ng-binding" ng-click="savePayment()" ng-disabled="locked" ng-show="showSaveButton"><i class="fa fa-floppy-o"></i>Lưu</a> <a ng-click="onCancel()" class="kv2Btn kv2BtnYellow ng-binding"><i class="fa fa-ban"></i>Bỏ qua</a>        <a href="javascript:void(0)" ng-click="voidPayment(item.Code,item.Value)" class="kv2Btn kv2BtnDel ng-binding ng-hide" ng-show="item.Id &amp;&amp; rights.canDelete"><i class="fa fa-close"></i>Hủy bỏ</a></div>
      <script type="text/x-angular-template"
      id="partnerSearchTempl">
        <li suggestion ng-repeat="suggestion in suggestions track by $index" index="{{$index}}" val="{{suggestion.name}}" ng-class="{active:($index == selectedIndex)}" ng-click="itemClicked(suggestion)">
          <p><b> {{suggestion.name}}</b>&nbsp;&nbsp; {{ suggestion.phone ?suggestion.phone: '' }}</p>
        </li>
      </script>
      <div style="display:none">
        <kv-partner-form form-name="partnerForm" class="ng-isolate-scope">
          <script type="text/x-angular-template" id="userSearchItemTempl">
            <li suggestion ng-repeat="suggestion in suggestions track by $index" index="{{$index}}" val="{{suggestion.name}}" ng-class="{active:($index == selectedIndex)}" ng-click="itemClicked(suggestion)">
              <p>{{suggestion.name}}</p> {{suggestion.id}} </li>
          </script>
        </kv-partner-form>
        <kv-cashgroup-form form-name="cashgroupForm" class="ng-isolate-scope"></kv-cashgroup-form>
        <kv-bank-account-form form-name="bankAccountPopup" class="ng-isolate-scope"></kv-bank-account-form>
      </div>
      <kv-popup id="cashflowHelp" class="uln ng-isolate-scope popupWrapper">
        <div class="kv2Pop pop popArrow" ng-transclude=""><span class="ng-binding ng-scope">Chọn trong trường hợp giá trị này là khoản Thu nhập thêm hoặc Chi phí vận hành, phát sinh của cửa hàng. Không chọn trong trường hợp Thu tiền hàng hoặc Trả tiền nhà cung cấp.</span></div>
      </kv-popup>
       
    </kv-cashflow-form>
  </div>
</div>
<div class="k-widget k-window k-window-poup k-window-poup-thn k-window-fix k-window-paymentDetail kv-window" data-role="draggable" style="padding-top: 42px; min-width: 90px; min-height: 50px; width: 880px; display: none; top: 121px; left: 239px; position: fixed; touch-action: pan-y; z-index: 10003; transform: scale(1); opacity: 1;">
  <div class="k-window-titlebar k-header" style="margin-top: -42px;">&nbsp;<span class="k-window-title">Phiếu thu</span>
    <div class="k-window-actions"><a role="button" href="#" class="k-window-action k-link"><span role="presentation" class="k-icon k-i-close">Close</span></a></div>
  </div>
  <div kendo-window="wdPaymentDetail" k-visible="false" k-pinned="true" k-draggable="true" k-width="880" k-resizable="false" k-modal="true" data-role="window" class="k-window-content k-content" tabindex="0" style="display: block;">
    <div class="form-wrapper form-labels-80 content-list">
      <div class="row row-padding-15">
        <div class="col-md-4 col-sm-6 form-labels-90">
          <div class="form-group">
            <label class="form-label control-label ng-binding">Mã phiếu thu:</label>
            <div class="form-wrap form-control-static"><strong class="ng-binding">TTHD000048</strong></div>
          </div>
          <div class="form-group">
            <label class="form-label control-label ng-binding">Thời gian:</label>
            <div class="form-wrap "><span class="k-widget k-datetimepicker k-header"><span class="k-picker-wrap k-state-default"><input kendo-date-time-picker="" ng-show="!disabled" k-ng-model="TransDate" k-format="'dd/MM/yyyy HH:mm'" k-time-format="'HH:mm'" data-role="datetimepicker" type="text" class="k-input" role="combobox" aria-expanded="false" aria-disabled="false" aria-readonly="false" style="width: 100%;"><span unselectable="on" class="k-select"><span unselectable="on" class="k-icon k-i-calendar" role="button">select</span>
              <span
              unselectable="on" class="k-icon k-i-clock" role="button">select</span>
                </span>
                </span>
                </span> <span ng-show="disabled" class="ng-binding ng-hide">01/08/2017 02:07</span></div>
          </div>
          <div class="form-group">
            <label class="form-label control-label ng-binding">Khách hàng:</label>
            <div class="form-wrap form-control-static">
              <a ng-href="#/Customers?Code=" ng-show="customerName!=''" target="_blank" class="txtU ng-binding ng-hide" ng-bind="customerName" href="#/Customers?Code="></a>
              <label ng-show="customerName==''" class="ng-binding">Khách lẻ</label>
            </div>
          </div>
        </div>
        <div class="col-md-4 col-sm-6">
          <div class="form-group">
            <label class="form-label control-label ng-binding">Người tạo:</label>
            <div class="form-wrap "><span title="" class="k-widget k-dropdown k-header" unselectable="on" role="listbox" aria-haspopup="true" aria-expanded="false" tabindex="0" aria-owns="" aria-disabled="false" aria-readonly="false" aria-busy="false" style="" aria-activedescendant="3774369d-0c1c-4e54-9607-6ccc7a1eaf9b"><span unselectable="on" class="k-dropdown-wrap k-state-default"><span unselectable="on" class="k-input ng-scope">trịnh công sơn</span>
              <span
              unselectable="on" class="k-select"><span unselectable="on" class="k-icon k-i-arrow-s">select</span></span>
                </span>
                <div class="k-animation-container" style="position: absolute;z-index: 112; display: none; box-sizing: content-box;width: 195px;"> 
                <div class="k-list-container k-popup k-group k-reset"> 
                    <div class="k-list-scroller" unselectable="on" style="height: auto;">
                    <ul unselectable="on" class="k-list k-reset" tabindex="-1" aria-hidden="true" aria-live="off" data-role="staticlist" role="listbox">
                     
                    </ul>
                    </div>
                    </div>
                </div>
                <select k-data-source="cursellers" k-data-text-field="'GivenName'" k-data-value-field="'Id'" k-ng-model="User" k-filter="'contains'" ng-show="!disabled" ng-disabled="disabled || rights.lockSeller" kendo-drop-down-list="" data-role="dropdownlist"
                style="display: none;">
                  <option value="92513">trịnh công sơn</option>
                   
                </select>
                </span><span ng-show="disabled" class="ng-binding ng-hide">trịnh công sơn</span></div>
          </div>
          <div class="form-group">
            <label class="form-label control-label ng-binding">Phương thức:</label>
            <div class="form-wrap "><span title="" class="k-widget k-dropdown k-header" unselectable="on" role="listbox" aria-haspopup="true" aria-expanded="false" tabindex="0" aria-owns="" aria-disabled="false" aria-readonly="false" aria-busy="false" style="" aria-activedescendant="3631e830-6d9f-4b21-bd86-c6115693fa9f"><span unselectable="on" class="k-dropdown-wrap k-state-default"><span unselectable="on" class="k-input ng-scope">Tiền mặt</span>
              <span
              unselectable="on" class="k-select"><span unselectable="on" class="k-icon k-i-arrow-s">select</span></span>
                </span>
                <select kendo-drop-down-list="" ng-hide="disabled" k-option-label="_m.globalSelect" k-data-text-field="'Label'" k-data-value-field="'Id'" k-data-source="paymentMethods" k-ng-model="paymentMedthodObj" ng-disabled="paymentMedthodObj.Id === 'Point'"
                data-role="dropdownlist" style="display: none;">
                  <option value="">---Lựa chọn---</option>
                  <option value="Cash">Tiền mặt</option>
                  <option value="Card">Thẻ</option>
                  <option value="Transfer">Chuyển khoản</option>
                </select>
                </span><span ng-show="disabled" class="ng-binding ng-hide">Tiền mặt</span></div>
          </div>
          <div class="form-group ng-hide" ng-show="paymentMedthodObj &amp;&amp; paymentMedthodObj.Id!= 'Cash' &amp;&amp; paymentMedthodObj.Id!= 'Point'">
            <label class="form-label control-label ng-binding">Số tài khoản:</label>
            <div class="form-wrap "><span title="" class="k-widget k-dropdown k-header ng-scope" unselectable="on" role="listbox" aria-haspopup="true" aria-expanded="false" tabindex="0" aria-owns="" aria-disabled="false" aria-readonly="false" aria-busy="false" style="" aria-activedescendant="a34e5bc1-86d1-43dd-b42d-3c17643e2668"><span unselectable="on" class="k-dropdown-wrap k-state-default"><span unselectable="on" class="k-input ng-binding ng-scope">---Lựa chọn---</span>
              <span
              unselectable="on" class="k-select"><span unselectable="on" class="k-icon k-i-arrow-s">select</span></span>
                </span>
                <select kendo-drop-down-list="" ng-hide="disabled" k-data-text-field="'Account'" k-data-value-field="'Id'" k-data-source="bankAccounts" k-rebind="bankAccounts" k-ng-model="BankAccount" k-options="customOptions" k-on-change="accountChanged(kendoEvent)"
                class="ng-scope" data-role="dropdownlist" style="display: none;">
                  <option value="0" selected="selected">---Lựa chọn---</option>
                </select>
                </span><span ng-show="disabled" class="ng-binding ng-hide">---Lựa chọn---</span></div>
          </div>
        </div>
        <div class="col-md-4 col-sm-12">
          <div ng-modal="dataItem.Description" ng-bind="dataItem.Description?dataItem.Description:'Ghi chú...'" ng-show="disabled" class="tblBox_Des tblBox_Des2 ng-binding ng-hide">Ghi chú...</div>
          <textarea maxlength="255" ng-model="description" placeholder="Ghi chú..." ng-show="!disabled" ng-disabled="disabled" class="tblBox_Des tblBox_Des2 ng-pristine ng-untouched ng-valid ng-empty ng-valid-maxlength" kv-textarea-enter=""></textarea>
        </div>
      </div>
    </div>
    <section class="popMore ovh mb20">
      <article class="clb ovh">
        <div id="grdDetailPayment" kendo-grid="" k-data-source="payments" k-sortable="true" k-resizable="false" k-pageable="false" k-columns="[{ &quot;field&quot;: &quot;TargetCode&quot;, &quot;title&quot;: _l.order_InvoiceCode, headerAttributes:{&quot;class&quot;: &quot;tdCode&quot;}, attributes:{&quot;class&quot;: &quot;tdCode&quot;}}, { &quot;field&quot;:&quot;TransDate&quot; , &quot;title&quot;:_l.lblTime , format:&quot;{0:dd/MM/yyyy HH:mm}&quot;, headerAttributes:{&quot;class&quot;: &quot;tdDateTime&quot;}, attributes:{&quot;class&quot;: &quot;tdDateTime&quot;}}, { &quot;field&quot;:&quot;OrderValue&quot; , &quot;title&quot;:_l.order_InvoiceValues, &quot;template&quot;: &quot;#=kendo.toString(Math.abs(OrderValue),\&quot;n0\&quot;)#&quot;,sortable:false,headerAttributes:{&quot;class&quot;: &quot;txtR&quot;}, attributes:{&quot;class&quot;: &quot;txtR&quot;}}, { &quot;field&quot;:&quot;PaidValue&quot; , &quot;title&quot;:order_InvoiceCustomerPay, &quot;template&quot;: &quot;#=kendo.toString(Math.abs(PaidValue),\&quot;n0\&quot;) #&quot;,headerAttributes:{&quot;class&quot;: &quot;txtR&quot;}, attributes:{&quot;class&quot;: &quot;txtR&quot;} }, { &quot;field&quot;:&quot;Amount&quot; , &quot;title&quot;:order_InvoicePay,&quot;template&quot;: &quot;#=kendo.toString((Amount > 0 ? Amount: -Amount),\&quot;n0\&quot;) #&quot;,headerAttributes:{&quot;class&quot;: &quot;txtR&quot;}, attributes:{&quot;class&quot;: &quot;txtR&quot;} }, { &quot;field&quot;:&quot;Status&quot; , &quot;title&quot;:_l.status, headerAttributes:{&quot;class&quot;: &quot;txtR&quot;}, attributes:{&quot;class&quot;: &quot;txtR&quot;} } ]"
        data-role="grid" class="k-grid k-widget">
          <div class="k-grid-header" style="padding-right: 8px;">
            <div class="k-grid-header-wrap k-auto-scrollable">
              <table role="grid">
                <colgroup>
                  <col>
                    <col>
                      <col>
                        <col>
                          <col>
                            <col>
                </colgroup>
                <thead role="rowgroup">
                  <tr role="row">
                    <th scope="col" role="columnheader" data-field="TargetCode" rowspan="1" data-title="Mã phiếu" data-index="0" id="2f968e12-a4e8-4b47-b68b-785f44409996" class="tdCode k-header ng-scope" data-role="columnsorter"><a class="k-link" href="#">Mã phiếu</a></th>
                    <th scope="col" role="columnheader" data-field="TransDate" rowspan="1" data-title="Thời gian" data-index="1" id="6c18c809-cec0-4e80-9570-64974bed352d" class="tdDateTime k-header ng-scope"
                    data-role="columnsorter"><a class="k-link" href="#">Thời gian</a></th>
                    <th scope="col" role="columnheader" data-field="OrderValue" rowspan="1" data-title="Giá trị phiếu" data-index="2" id="aee4eed9-d670-44b5-9db7-8e2d5ecf00b2" class="txtR k-header ng-scope">Giá trị phiếu</th>
                    <th scope="col" role="columnheader" data-field="PaidValue" rowspan="1" data-title="Đã thu trước" data-index="3" id="34653560-235f-499d-95c8-9b01fd53fb09" class="txtR k-header ng-scope" data-role="columnsorter"><a class="k-link" href="#">Đã thu trước</a></th>
                    <th scope="col" role="columnheader" data-field="Amount" rowspan="1" data-title="Tiền thu" data-index="4" id="6ccdbdca-726e-4a93-8934-e694b4a7e69e" class="txtR k-header ng-scope" data-role="columnsorter"><a class="k-link" href="#">Tiền thu</a></th>
                    <th scope="col" role="columnheader" data-field="Status" rowspan="1" data-title="Trạng thái" data-index="5" id="167b2641-974d-49ae-9cb8-1b415e20a893" class="txtR k-header ng-scope" data-role="columnsorter"><a class="k-link" href="#">Trạng thái</a></th>
                  </tr>
                </thead>
              </table>
            </div>
          </div>
          <div class="k-grid-content k-auto-scrollable k-grid-content-ac">
            <table role="grid">
              <colgroup>
                <col>
                  <col>
                    <col>
                      <col>
                        <col>
                          <col>
              </colgroup>
              <tbody role="rowgroup">
                <tr data-uid="4c0eb6e5-4b4d-420f-9c6b-6706e7a7b02b" role="row" class="ng-scope">
                  <td class="tdCode" role="gridcell"><span ng-bind="dataItem.TargetCode" class="ng-binding">HD000048</span></td>
                  <td class="tdDateTime" role="gridcell">01/08/2017 02:07</td>
                  <td class="txtR" role="gridcell">50,000</td>
                  <td class="txtR" role="gridcell">0</td>
                  <td class="txtR" role="gridcell">50,000</td>
                  <td class="txtR" role="gridcell"><span ng-bind="dataItem.Status" class="ng-binding">Đã thanh toán</span></td>
                </tr>
              </tbody>
            </table><span class="line" style="height: 409px; top: 127px;"></span><span class="line line2" style="height: 409px; top: 127px;"></span></div>
        </div>
      </article>
    </section>
    <aside class="form-wrapper flr txtR tblTotal tblBox">
      <div class="table-responsive">
        <table class="">
          <tbody>
            <tr>
              <td class="ng-binding">Tổng tiền thu:</td>
              <td class="space"></td>
              <td class="txtB totalPrice ng-binding">50,000</td>
            </tr>
          </tbody>
        </table>
      </div>
    </aside>
    <div class="clb"></div>
    <div class="kv-window-footer"><a ng-hide="disabled" ng-click="update()" class="kv2Btn ng-binding"><i class="fa fa-check-square"></i> Cập nhật</a> <a ng-click="print()" class="kv2Btn kv2BtnYellow ng-binding"><i class="fa fa-print"></i> In</a> <a href="javascript:void(0)" ng-click="cancel()" class="kv2Btn kv2BtnDel ng-binding"
      ng-hide="disabled || !rights.canDelete"><i class="fa fa-close"></i> Hủy bỏ</a></div>
  </div>
</div>

<div class="k-widget k-window k-window-poup k-window-cashgroup kv-window" data-role="draggable" style="padding-top: 42px; min-width: 90px; min-height: 50px; width: 550px; display: none; top: 0px; left: 404px; position: fixed; touch-action: pan-y; z-index: 10017; transform: scale(1); opacity: 1;">
  <div class="k-window-titlebar k-header" style="margin-top: -42px;">&nbsp;<span class="k-window-title">Thêm loại thu</span>
    <div class="k-window-actions"><a role="button" href="#" class="k-window-action k-link"><span role="presentation" class="k-icon k-i-close">Close</span></a></div>
  </div>
  <div kendo-window="cashgroupWindow" k-visible="false" k-resizable="false" k-draggable="true" k-pinned="true" k-width="550" k-modal="true" data-role="window" class="k-window-content k-content" tabindex="0" style="display: block;">
    <div class="form-wrapper form-labels-80">
      <div class="form-group">
        <label class="form-label control-label ng-binding">Loại thu</label>
        <div class="form-wrap">
          <input type="text" class="form-control iptFocus ng-pristine ng-empty ng-invalid-required ng-touched" ng-model="group.Name" required="">
        </div>
      </div>
      <div class="form-group">
        <label class="form-label control-label ng-binding">Mô tả</label>
        <div class="form-wrap">
          <textarea rows="5" class="form-control ng-pristine ng-valid ng-empty ng-touched" ng-model="group.Description"></textarea>
        </div>
      </div>
      <div class="form-group">
        <div class="form-wrap">
          <aside class="frRadioCheck dpb fll has-pretty-child">
            <div class="clearfix prettycheckbox labelright  blue">
              <input type="checkbox" ng-checked="group.UsedForFinancialReporting" name="financial" kv-pretty-check="" ng-model="group.UsedForFinancialReporting" kv-disabled="partnerType == 'C' || partnerType == 'S'" kv-data-label="_l.cashflow_UsetoReport"
              class="ng-pristine ng-untouched ng-valid ng-isolate-scope ng-not-empty" data-label="Hạch toán vào kết quả hoạt động kinh doanh" style="display: none;" checked="checked">
              <a href="javascript:void(0)" tabindex="1000007" class="checked"></a>
              <label for="undefined" class="checked">Hạch toán vào kết quả hoạt động kinh doanh</label>
            </div>
          </aside>
          <a href="javascript:void(0)" tabindex="0" class="help icon" kv-tooltip="" data-toggle="tooltip" data-placement="right" data-original-title="Chọn trong trường hợp giá trị này là khoản Thu nhập thêm hoặc Chi phí vận hành, phát sinh của cửa hàng. Không chọn trong trường hợp Thu tiền hàng hoặc Trả tiền nhà cung cấp."><i class="fa fa-info-circle"></i></a>
        </div>
      </div>
    </div>
    <div class="kv-window-footer"><a href="" class="kv2Btn ng-binding" ng-click="saveCashgroup()"><i class="fa fa-floppy-o"></i>Lưu</a> <a href="javascript:void(0)" class="kv2Btn kv2BtnYellow ng-binding" ng-click="cancel()"><i class="fa fa-ban"></i>Bỏ qua</a> <a href="" class="kv2Btn kv2BtnDel ng-binding ng-hide"
      ng-show="group.Id>0" ng-click="delete()"><i class="fa fa-trash"></i>Xóa</a></div>
    <kv-popup id="cashflowH" class="uln ng-isolate-scope popupWrapper">
      <div class="kv2Pop pop popArrow" ng-transclude=""><span class="ng-binding ng-scope">Chọn trong trường hợp giá trị này là khoản Thu nhập thêm hoặc Chi phí vận hành, phát sinh của cửa hàng. Không chọn trong trường hợp Thu tiền hàng hoặc Trả tiền nhà cung cấp.</span></div>
    </kv-popup>
  </div>
</div>

<div class="k-widget k-window k-window-poup k-window-cashflowparner kv-window" data-role="draggable" style="padding-top: 42px; min-width: 90px; min-height: 50px; width: 550px; display: none; top: 0px; left: 404px; position: fixed; touch-action: pan-y; z-index: 10045; opacity: 1; transform: scale(1);">
  <div class="k-window-titlebar k-header" style="margin-top: -42px;">&nbsp;<span class="k-window-title">Thêm người nộp</span>
    <div class="k-window-actions"><a role="button" href="#" class="k-window-action k-link"><span role="presentation" class="k-icon k-i-close">Close</span></a></div>
  </div>
  <div kendo-window="partnerWindow" k-visible="false" k-resizable="false" k-draggable="true" k-pinned="true" k-width="550" k-modal="true" onclose="closePartner()" data-role="window" class="k-window-content k-content" style="display: block;" tabindex="0">
    <div class="form-wrapper form-labels-90">
      <div class="form-group">
        <label class="form-label control-label ng-binding">Người nộp</label>
        <div class="form-wrap">
          <input type="text" class="form-control iptFocus ng-pristine ng-empty ng-invalid-required ng-touched" ng-model="partner.Name" required="">
        </div>
      </div>
      <div class="form-group">
        <label class="form-label control-label ng-binding">Điện thoại</label>
        <div class="form-wrap">
          <input type="text" class="form-control ng-pristine ng-untouched ng-valid ng-empty" ng-model="partner.ContactNo">
        </div>
      </div>
      <div class="form-group">
        <label class="form-label control-label ng-binding">Địa chỉ</label>
        <div class="form-wrap">
          <input type="text" class="form-control ng-pristine ng-untouched ng-valid ng-empty ng-valid-maxlength" ng-model="partner.Address" maxlength="255">
        </div>
      </div>
      <kv-search-location kv-model="partner" class="ng-isolate-scope hth-hide">
        <div class="form-group">
          <label class="form-label control-label ng-binding">Khu vực</label>
          <div class="form-wrap loc ">
            <div class="loc" ng-show="!kvModel.disabled &amp;&amp; !kvModel.hasIssued" ng-disabled="kvModel.disabled || kvModel.hasIssued">
              <autocomplete ng-model="kvModel.LocationName" attr-placeholder="Chọn Tỉnh/TP - Quận/Huyện" template-id="locationItemTempl" attr-inputid="locationSearchInput" data="locations" on-type="locationTermChanged" on-select="selectLocation" class="ng-pristine ng-untouched ng-valid ng-isolate-scope ng-empty">
                <div class="autocomplete " id="">
                  <input type="text" ng-model="searchParam" placeholder="Chọn Tỉnh/TP - Quận/Huyện" class="ng-empty" id="locationSearchInput" tabindex="" ng-disabled="kvDisable" kv-select-text="">
                  <div ng-show="completing" class="ng-hide">
                    <ul>
                      <!-- ngRepeat: suggestion in suggestions track by $index -->
                    </ul>
                    <div class="autoNotFound ng-hide" ng-show="searchParam &amp;&amp; suggestions.length == 0">Không tìm thấy kết quả nào phù hợp</div>
                  </div>
                </div>
              </autocomplete>
            </div><span ng-show="kvModel.disabled || kvModel.hasIssued" class="ng-binding ng-hide"></span></div>
        </div>
        <div class="form-group mb10">
          <label class="form-label control-label ng-binding">Phường xã</label>
          <div class="form-wrap ">
            <div class="w" ng-show="!kvModel.disabled &amp;&amp; !kvModel.hasIssued" ng-disabled="kvModel.disabled || kvModel.hasIssued">
              <autocomplete ng-model="kvModel.WardName" attr-placeholder="Chọn Phường/Xã" template-id="wardItemTempl" attr-inputid="wardSearchInput" data="wards" on-type="wardTermChanged" on-select="selectWard" class="ng-pristine ng-untouched ng-valid ng-isolate-scope ng-empty">
                <div class="autocomplete " id="">
                  <input type="text" ng-model="searchParam" placeholder="Chọn Phường/Xã" class="ng-empty" id="wardSearchInput" tabindex="" ng-disabled="kvDisable" kv-select-text="">
                  <div ng-show="completing" class="ng-hide">
                    <ul>
                      <!-- ngRepeat: suggestion in suggestions track by $index -->
                    </ul>
                    <div class="autoNotFound ng-hide" ng-show="searchParam &amp;&amp; suggestions.length == 0">Không tìm thấy kết quả nào phù hợp</div>
                  </div>
                </div>
              </autocomplete>
            </div><span ng-show="kvModel.disabled || kvModel.hasIssued" class="ng-binding ng-hide"></span></div>
        </div>
      </kv-search-location>
      <div class="form-group">
        <label class="form-label control-label ng-binding">Ghi chú</label>
        <div class="form-wrap">
          <textarea rows="5" class="form-control ng-pristine ng-untouched ng-valid ng-empty" ng-model="partner.Description"></textarea>
        </div>
      </div>
    </div>
    <div class="kv-window-footer"><a href="" class="kv2Btn ng-binding" ng-click="savePartner()"><i class="fa fa-floppy-o"></i>Lưu</a> <a href="javascript:void(0)" class="kv2Btn kv2BtnYellow ng-binding" ng-click="cancel()"><i class="fa fa-ban"></i>Bỏ qua</a> <a href="" class="kv2Btn kv2BtnDel ng-binding ng-hide"
      ng-show="partner.Id>0" ng-click="delete()"><i class="fa fa-trash"></i>Xóa</a></div>
  </div>
</div>

<div class="k-widget k-window k-window-fix k-window-cashflowbank kv-window" data-role="draggable" style="padding-top: 42px; min-width: 90px; min-height: 50px; width: 480px; display: none; top: 79px; left: 440px; position: fixed; touch-action: pan-y; z-index: 10005; opacity: 1; transform: scale(1);">
  <div class="k-window-titlebar k-header" style="margin-top: -42px;">&nbsp;<span class="k-window-title">Thêm tài khoản</span>
    <div class="k-window-actions"><a role="button" href="#" class="k-window-action k-link"><span role="presentation" class="k-icon k-i-close">Close</span></a></div>
  </div>
  <div kendo-window="bankWindow" k-visible="false" k-resizable="false" k-draggable="true" k-pinned="true" k-width="480" k-modal="true" data-role="window" class="k-window-content k-content" tabindex="0" style="display: block;">
    <div class="form-wrapper">
      <div class="form-group"><label class="form-label control-label ng-binding">Tên tài khoản</label>
        <div class="form-wrap"><input type="text" class="form-control-kv iptFocus ng-pristine ng-empty ng-invalid ng-invalid-required ng-touched" ng-model="account.Bank" required=""></div>
      </div>
      <div class="form-group"><label class="form-label control-label ng-binding">Số tài khoản</label>
        <div class="form-wrap"><input type="text" class="form-control-kv ng-pristine ng-valid ng-empty ng-touched" ng-model="account.Account"></div>
      </div>
      <div class="form-group">
        <kv-search-bank kv-model="account" kv-default-option-label="_l.bank_DefaultOption" kv-change="onBankChange" kv-text-field="'FullName'" kv-value-field="'Code'" class="ng-isolate-scope">
          <div class="form-group form-group__select"><label class="form-label control-label ng-binding">Ngân hàng</label>
            <div class="form-wrap"><span>
            <select k-options="customOptions" k-data-source="banks" k-data-text-field="textField" k-data-value-field="valueField" k-value-primitive="true" k-ng-model="model.BankCode" kendo-drop-down-list="banksDropDownList" data-role="dropdownlist" style="display: none;">                  
            </select>
            </span></div>
          </div>
          
        </kv-search-bank>
      </div>
      <div class="form-group"><label class="form-label control-label ng-binding">Chi nhánh</label>
        <div class="form-wrap"><input type="text" class="form-control-kv ng-pristine ng-valid ng-empty ng-valid-maxlength ng-touched" ng-model="account.Branch" placeholder="Nhập chi nhánh" maxlength="255"></div>
      </div>
      <div class="form-group"><label class="form-label control-label ng-binding">Chủ tài khoản</label>
        <div class="form-wrap"><input type="text" class="form-control-kv ng-pristine ng-valid ng-empty ng-valid-maxlength ng-touched" ng-model="account.AccountName" placeholder="Chủ tài khoản" maxlength="255"></div>
      </div>
      <div class="form-group"><label class="form-label control-label ng-binding">Ghi chú</label>
        <div class="form-wrap"><textarea rows="5" class="form-control-kv textarea-autoHeight ng-pristine ng-valid ng-empty ng-touched" ng-model="account.Description" ng-keyup="autoResize($event)" style="height: 32px;"></textarea></div>
      </div>
    </div>
    <div class="kv-window-footer"><a href="" class="kv2Btn ng-binding" ng-click="saveAccount()"><i class="fa fa-floppy-o"></i>Lưu</a> <a href="" class="kv2Btn kv2BtnYellow ng-binding" ng-click="cancel()"><i class="fa fa-ban"></i>Bỏ qua</a> <a href="" class="kv2Btn kv2BtnDel ng-binding ng-hide" ng-show="account.Id>0" ng-click="delete()"><i class="fa fa-trash"></i>Xóa</a></div>
  </div>
</div>
